<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∞ Poker Casino - 3 Format</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.0/signalr.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1419 100%);
            min-height: 100vh;
            color: #fff;
            position: relative;
            overflow-x: hidden;
        }

            body::before {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(circle at 20% 50%, rgba(74, 222, 128, 0.03) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.03) 0%, transparent 50%);
                animation: bgPulse 15s ease-in-out infinite;
                pointer-events: none;
                z-index: 0;
            }

        @keyframes bgPulse {
            0%, 100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            padding: 30px 20px;
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 3s ease-in-out infinite;
            margin-bottom: 10px;
        }

        @keyframes shimmer {
            0%, 100% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.3);
            }
        }

        .header .subtitle {
            margin-top: 10px;
            font-size: 1.1rem;
            color: #4ade80;
        }

        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.05);
            padding: 20px 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(74, 222, 128, 0.2);
        }

        .balance {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4ade80;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.5);
        }

        .game-type-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .badge-no-limit {
            background: linear-gradient(135deg, #dc2626, #991b1b);
            border: 2px solid #ef4444;
        }

        .badge-limit {
            background: linear-gradient(135deg, #22c55e, #15803d);
            border: 2px solid #4ade80;
        }

        .badge-pot-limit {
            background: linear-gradient(135deg, #f59e0b, #b45309);
            border: 2px solid #fbbf24;
        }

        .room-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .room-card {
            background: linear-gradient(145deg, rgba(45, 90, 143, 0.4), rgba(30, 60, 114, 0.4));
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }

            .room-card:hover {
                transform: translateY(-10px) scale(1.02);
                border-color: #4ade80;
                box-shadow: 0 15px 40px rgba(74, 222, 128, 0.3);
            }

            .room-card h3 {
                color: #ffd700;
                margin-bottom: 15px;
                font-size: 1.4rem;
            }

        .room-info {
            margin: 10px 0;
            line-height: 1.8;
        }

            .room-info div {
                margin: 5px 0;
            }

        .join-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            border: none;
            border-radius: 10px;
            color: #000;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
            text-transform: uppercase;
        }

            .join-btn:hover {
                background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(34, 197, 94, 0.4);
            }

        .game-section {
            display: none;
        }

            .game-section.active {
                display: block;
            }

        .game-info-bar {
            background: linear-gradient(145deg, rgba(0,0,0,0.7), rgba(0,0,0,0.5));
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            border: 2px solid #4ade80;
            backdrop-filter: blur(10px);
        }

            .game-info-bar h2 {
                color: #ffd700;
                margin-bottom: 10px;
                font-size: 1.8rem;
            }

        .game-type-description {
            font-size: 1.1rem;
            color: #4ade80;
            margin: 10px 0;
        }

        .game-balance-info {
            margin-top: 10px;
            font-size: 1rem;
        }

        .rebuy-countdown-banner {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #f59e0b, #d97706);
            padding: 20px 40px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(245, 158, 11, 0.6);
            z-index: 5000;
            text-align: center;
            border: 3px solid #fbbf24;
            display: none;
            animation: bounceIn 0.6s ease-out;
        }

        @keyframes bounceIn {
            0% {
                transform: translateX(-50%) scale(0.3);
                opacity: 0;
            }

            50% {
                transform: translateX(-50%) scale(1.05);
            }

            100% {
                transform: translateX(-50%) scale(1);
                opacity: 1;
            }
        }

        .rebuy-countdown-banner.active {
            display: block;
        }

        .rebuy-countdown-timer {
            font-size: 3rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            margin: 10px 0;
        }

        .poker-table {
            background: linear-gradient(145deg, #0f5132, #1e7e34);
            border: 20px solid #8b4513;
            border-radius: 50%;
            width: 90%;
            max-width: 900px;
            aspect-ratio: 1.5;
            margin: 0 auto 150px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.7);
        }

        .table-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 60%;
        }

        .pot-amount {
            font-size: 2rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .current-bet-display {
            margin: 8px 0;
            color: #fff;
            font-size: 1.1rem;
        }

        .community-cards-area {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }

        .player-spot {
            position: absolute;
            width: 160px;
            text-align: center;
        }

            .player-spot .player-cards {
                display: flex;
                gap: 5px;
                justify-content: center;
                margin-top: 10px;
            }

            .player-spot .player-card {
                width: 45px;
                height: 63px;
                background: #fff;
                border-radius: 6px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            }

                .player-spot .player-card.red {
                    color: #dc2626;
                }

                .player-spot .player-card.black {
                    color: #000;
                }

            .player-spot.bottom {
                bottom: -100px;
                left: 50%;
                transform: translateX(-50%);
            }

            .player-spot.top {
                top: -100px;
                left: 50%;
                transform: translateX(-50%);
            }

            .player-spot.left {
                left: -120px;
                top: 50%;
                transform: translateY(-50%);
            }

            .player-spot.right {
                right: -120px;
                top: 50%;
                transform: translateY(-50%);
            }

            .player-spot.top-left {
                top: 5%;
                left: 5%;
            }

            .player-spot.top-right {
                top: 5%;
                right: 5%;
            }

            .player-spot.bottom-left {
                bottom: 5%;
                left: 5%;
            }

            .player-spot.bottom-right {
                bottom: 5%;
                right: 5%;
            }

            .player-spot .showdown-cards {
                display: flex;
                gap: 4px;
                justify-content: center;
                margin-top: 8px;
                opacity: 0;
                transition: opacity 0.5s;
            }

                .player-spot .showdown-cards.visible {
                    opacity: 1;
                }

            .player-spot .showdown-hand-name {
                font-size: 0.75rem;
                color: #ffd700;
                margin-top: 4px;
                font-weight: bold;
                text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
                opacity: 0;
                transition: opacity 0.5s;
            }

                .player-spot .showdown-hand-name.visible {
                    opacity: 1;
                }

        .player-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(145deg, #4ade80, #22c55e);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            margin: 0 auto 10px;
            border: 4px solid #ffd700;
            position: relative;
            cursor: pointer;
            transition: all 0.4s;
        }

            .player-avatar.folded {
                opacity: 0.3;
                filter: grayscale(100%);
            }

            .player-avatar.active {
                box-shadow: 0 0 20px #ffd700;
                animation: pulse 1.5s infinite;
            }

            .player-avatar.winner {
                border-color: #ffd700;
                box-shadow: 0 0 40px #ffd700;
                animation: winnerGlow 1.5s infinite;
            }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 20px #ffd700;
            }

            50% {
                box-shadow: 0 0 40px #ffd700;
            }
        }

        @keyframes winnerGlow {
            0%, 100% {
                box-shadow: 0 0 40px #ffd700;
                transform: scale(1);
            }

            50% {
                box-shadow: 0 0 60px #ffd700;
                transform: scale(1.1);
            }
        }

        .player-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #fff;
            font-size: 0.95rem;
        }

        .player-chips {
            color: #4ade80;
            font-size: 0.85rem;
        }

        .player-bet {
            color: #ffd700;
            font-size: 0.8rem;
            margin-top: 3px;
        }

        .player-status {
            color: #dc2626;
            font-size: 0.8rem;
            margin-top: 3px;
        }

        .hand-cards {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            justify-content: center;
            gap: 10px;
            z-index: 100;
            padding: 15px 25px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 2px solid #4ade80;
        }

        .card {
            width: 110px;
            height: 154px;
            background: #fff;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
            transition: all 0.4s;
            animation: cardDeal 0.5s ease-out;
        }

        @keyframes cardDeal {
            from {
                opacity: 0;
                transform: translateY(-100px) rotate(-180deg);
            }

            to {
                opacity: 1;
                transform: translateY(0) rotate(0);
            }
        }

        .card:hover {
            transform: translateY(-20px) rotate(5deg) scale(1.1);
        }

        .card.red {
            color: #dc2626;
        }

        .card.black {
            color: #000;
        }

        .card-rank {
            font-size: 2.5rem;
        }

        .card-suit {
            font-size: 3rem;
        }

        .mini-card {
            width: 45px;
            height: 63px;
            background: #fff;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            animation: cardDeal 0.3s ease-out;
        }

        .mini-card-showdown {
            width: 38px;
            height: 53px;
            background: #fff;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(0,0,0,0.5);
            animation: cardFlip 0.6s ease-out;
        }

        @keyframes cardFlip {
            0% {
                transform: rotateY(180deg);
                opacity: 0;
            }

            100% {
                transform: rotateY(0deg);
                opacity: 1;
            }
        }

        .mini-card.red, .mini-card-showdown.red {
            color: #dc2626;
        }

        .mini-card.black, .mini-card-showdown.black {
            color: #000;
        }

        .actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

            .btn:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            .btn:hover:not(:disabled) {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            }

        .btn-fold {
            background: #dc2626;
            color: #fff;
        }

        .btn-call {
            background: #3b82f6;
            color: #fff;
        }

        .btn-raise {
            background: #fbbf24;
            color: #000;
        }

        .btn-check {
            background: #3b82f6;
            color: #fff;
        }

        .btn-allin {
            background: #f59e0b;
            color: #fff;
        }

        .btn-rebuy {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: #fff;
            animation: rebuyPulse 2s infinite;
        }

        @keyframes rebuyPulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(245, 158, 11, 0.6);
            }

            50% {
                box-shadow: 0 0 40px rgba(245, 158, 11, 1);
            }
        }

        .btn-leave {
            background: #6b7280;
            color: #fff;
        }

        .raise-slider-panel {
            position: fixed;
            bottom: -250px;
            left: 0;
            right: 0;
            background: linear-gradient(145deg, rgba(20, 40, 80, 0.98), rgba(30, 60, 114, 0.98));
            padding: 30px;
            backdrop-filter: blur(10px);
            border-top: 3px solid #4ade80;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.7);
            transition: bottom 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
        }

            .raise-slider-panel.active {
                bottom: 0;
            }

        .raise-slider-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .raise-amount-display {
            background: rgba(0,0,0,0.6);
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 2.5rem;
            font-weight: bold;
            color: #ffd700;
            min-width: 200px;
            text-align: center;
            border: 3px solid #4ade80;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }

        .raise-slider-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
            color: #fff;
            font-size: 0.9rem;
        }

        .raise-slider {
            flex: 1;
            min-width: 300px;
            height: 15px;
            border-radius: 10px;
            background: linear-gradient(to right, #dc2626, #f59e0b, #4ade80);
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

            .raise-slider::-webkit-slider-thumb {
                -webkit-appearance: none;
                appearance: none;
                width: 35px;
                height: 35px;
                border-radius: 50%;
                background: #ffd700;
                cursor: pointer;
                box-shadow: 0 0 20px rgba(255, 215, 0, 1);
                border: 4px solid #fff;
            }

            .raise-slider::-moz-range-thumb {
                width: 35px;
                height: 35px;
                border-radius: 50%;
                background: #ffd700;
                cursor: pointer;
                box-shadow: 0 0 20px rgba(255, 215, 0, 1);
                border: 4px solid #fff;
            }

        .raise-slider-buttons {
            display: flex;
            gap: 15px;
        }

        .btn-slider-ok {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: #000;
            padding: 18px 50px;
            font-size: 1.4rem;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

            .btn-slider-ok:hover {
                transform: scale(1.08);
                box-shadow: 0 8px 25px rgba(74, 222, 128, 0.6);
            }

        .btn-slider-cancel {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: #fff;
            padding: 18px 50px;
            font-size: 1.4rem;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

            .btn-slider-cancel:hover {
                transform: scale(1.08);
                box-shadow: 0 8px 25px rgba(107, 114, 128, 0.6);
            }

        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px 30px;
            border-radius: 12px;
            font-weight: bold;
            z-index: 10000;
            animation: slideInRight 0.4s ease-out;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 2px solid;
            max-width: 400px;
        }

            .message.success {
                background: rgba(34, 197, 94, 0.95);
                color: #fff;
                border-color: #22c55e;
            }

            .message.error {
                background: rgba(220, 38, 38, 0.95);
                color: #fff;
                border-color: #dc2626;
            }

            .message.info {
                background: rgba(59, 130, 246, 0.95);
                color: #fff;
                border-color: #3b82f6;
            }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ffd700;
            animation: confettiFall 3s ease-out forwards;
            z-index: 9999;
        }

        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ô† POKER ‚ô•</h1>
            <div class="subtitle">üî¥ No-Limit | üü¢ Limit | üü° Pot-Limit</div>
        </div>

        <!-- Buy-in Se√ßimi Modal -->
        <div id="buyInModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; align-items: center; justify-content: center;">
            <div style="background: #1e293b; padding: 30px; border-radius: 15px; max-width: 400px; width: 90%; box-shadow: 0 10px 50px rgba(0,0,0,0.7);">
                <h3 style="color: #10b981; margin-bottom: 20px; text-align: center; font-size: 1.5rem;">üí∞ Buy-in M…ôbl…ôƒüi Se√ßin</h3>

                <div style="margin-bottom: 20px;">
                    <label style="color: #94a3b8; font-size: 14px; display: block; margin-bottom: 8px; font-weight: 600;">
                        M…ôbl…ôƒü (Min: <span id="minBuyIn">0</span>‚Çº - Max: <span id="maxBuyIn">0</span>‚Çº)
                    </label>
                    <input type="number"
                           id="buyInInput"
                           style="
                    width: 100%;
                    padding: 12px;
                    border-radius: 8px;
                    border: 2px solid #334155;
                    background: #0f172a;
                    color: white;
                    font-size: 16px;
                    font-weight: bold;
                    box-sizing: border-box;
                "
                           placeholder="M…ôbl…ôƒü daxil edin"
                           inputmode="numeric" />
                </div>

                <!-- Hazƒ±r m…ôbl…ôƒül…ôr -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
                    <button onclick="setQuickBuyIn('min')"
                            style="
                    padding: 10px;
                    background: linear-gradient(135deg, #3b82f6, #1e40af);
                    border: 2px solid transparent;
                    border-radius: 8px;
                    color: white;
                    cursor: pointer;
                    font-weight: 600;
                    transition: all 0.3s;
                "
                            onmouseover="this.style.borderColor='#60a5fa'"
                            onmouseout="this.style.borderColor='transparent'">
                        üîΩ Min
                    </button>
                    <button onclick="setQuickBuyIn('mid')"
                            style="
                    padding: 10px;
                    background: linear-gradient(135deg, #f59e0b, #d97706);
                    border: 2px solid transparent;
                    border-radius: 8px;
                    color: white;
                    cursor: pointer;
                    font-weight: 600;
                    transition: all 0.3s;
                "
                            onmouseover="this.style.borderColor='#fbbf24'"
                            onmouseout="this.style.borderColor='transparent'">
                        ‚öñÔ∏è Orta
                    </button>
                    <button onclick="setQuickBuyIn('max')"
                            style="
                    padding: 10px;
                    background: linear-gradient(135deg, #10b981, #059669);
                    border: 2px solid transparent;
                    border-radius: 8px;
                    color: white;
                    cursor: pointer;
                    font-weight: 600;
                    transition: all 0.3s;
                "
                            onmouseover="this.style.borderColor='#6ee7b7'"
                            onmouseout="this.style.borderColor='transparent'">
                        üîº Max
                    </button>
                </div>

                <div style="display: flex; gap: 12px;">
                    <button onclick="closeBuyInModal()"
                            style="
                    flex: 1;
                    padding: 12px;
                    background: linear-gradient(135deg, #6b7280, #4b5563);
                    border: none;
                    border-radius: 8px;
                    color: white;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                "
                            onmouseover="this.style.transform='scale(1.05)'"
                            onmouseout="this.style.transform='scale(1)'">
                        ‚ùå L…ôƒüv et
                    </button>
                    <button onclick="confirmBuyIn()"
                            style="
                    flex: 1;
                    padding: 12px;
                    background: linear-gradient(135deg, #10b981, #059669);
                    border: none;
                    border-radius: 8px;
                    color: white;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                "
                            onmouseover="this.style.transform='scale(1.05); box-shadow=0 10px 25px rgba(16, 185, 129, 0.6);'"
                            onmouseout="this.style.transform='scale(1)'">
                        ‚úÖ T…ôsdiq et
                    </button>
                </div>
            </div>
        </div>

        <!-- Re-buy Modal -->
        <div id="reBuyModal" style="display: none;">
            <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; display: flex; align-items: center; justify-content: center;">
                <div style="background: #1e293b; padding: 30px; border-radius: 15px; max-width: 400px; width: 90%; box-shadow: 0 10px 50px rgba(0,0,0,0.5);">
                    <h3 style="color: #fbbf24; margin-bottom: 20px; text-align: center; font-size: 24px;">üîÑ Re-buy M…ôbl…ôƒüi Se√ßin</h3>

                    <div style="margin-bottom: 20px;">
                        <label style="color: #94a3b8; font-size: 14px; display: block; margin-bottom: 8px;">
                            M…ôbl…ôƒü (Min: <span id="reBuyMinAmount">0</span>‚Çº - Max: <span id="reBuyMaxAmount">0</span>‚Çº)
                        </label>
                        <input type="number" id="reBuyInput"
                               style="width: 100%; padding: 12px; border-radius: 8px; border: 2px solid #334155; background: #0f172a; color: white; font-size: 16px; box-sizing: border-box;"
                               placeholder="M…ôbl…ôƒü daxil edin">
                    </div>

                    <!-- Hazƒ±r m…ôbl…ôƒül…ôr -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
                        <button onclick="setQuickReBuy('min')" style="padding: 10px; background: #f59e0b; border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: 600;">
                            Min
                        </button>
                        <button onclick="setQuickReBuy('mid')" style="padding: 10px; background: #f59e0b; border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: 600;">
                            Orta
                        </button>
                        <button onclick="setQuickReBuy('max')" style="padding: 10px; background: #f59e0b; border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: 600;">
                            Max
                        </button>
                    </div>

                    <div style="display: flex; gap: 12px;">
                        <button onclick="closeReBuyModal()" style="flex: 1; padding: 12px; background: #ef4444; border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer;">
                            L…ôƒüv et
                        </button>
                        <button onclick="confirmReBuy()" style="flex: 1; padding: 12px; background: #10b981; border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer;">
                            T…ôsdiq et
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="user-info">
            <div><strong id="userName">Y√ºkl…ônir...</strong></div>
            <div class="balance">üí∞ <span id="userBalance">0</span> AZN</div>
        </div>

        <div class="rebuy-countdown-banner" id="rebuyCountdownBanner">
            <div style="font-size: 1.2rem; margin-bottom: 10px;">‚è≥ RE-BUY VAXT</div>
            <div class="rebuy-countdown-timer" id="rebuyCountdownTimer">20</div>
            <div style="font-size: 0.9rem;" id="rebuyWaitingPlayers"></div>
        </div>

        <div id="roomListSection">
            <h2 style="margin-bottom: 15px;">üéÆ Poker Otaqlarƒ±</h2>
            <div class="room-grid" id="roomGrid">
                <div style="text-align: center; padding: 40px;">Y√ºkl…ônir...</div>
            </div>
        </div>

        <div id="gameSection" class="game-section">
            <div class="game-info-bar">
                <h2>
                    <span id="gameTypeIcon">üéÆ</span>
                    <span id="currentRoomName">-</span>
                </h2>
                <div class="game-type-description" id="gameTypeDescription">No-Limit Texas Hold'em</div>
                <div class="game-balance-info">
                    Balans: <span id="gameBalance">0</span> AZN |
                    √áipl…ôr: <span id="playerChips" style="color: #4ade80;">0</span>
                </div>
            </div>

            <div class="poker-table" id="pokerTable">
                <div class="table-center">
                    <div class="pot-amount">POT: <span id="potAmount">0</span></div>
                    <div class="current-bet-display">M…ôrc: <span id="currentBet">0</span></div>
                    <div class="community-cards-area" id="communityCards"></div>
                </div>
            </div>

            <div class="hand-cards" id="handCards">
                <div style="color: #ffd700; text-align: center;">Kartlarƒ±nƒ±zƒ± g√∂zl…ôyin...</div>
            </div>

            <div class="actions">
                <button class="btn btn-fold" id="foldBtn" onclick="playerAction('fold')" disabled>FOLD</button>
                <button class="btn btn-check" id="checkBtn" onclick="playerAction('check')" disabled>CHECK</button>
                <button class="btn btn-call" id="callBtn" onclick="playerAction('call')" disabled>
                    CALL <span id="callAmount" style="font-weight: bold; color: #ffd700;"></span>
                </button>
                <button class="btn btn-raise" id="raiseBtn" onclick="openRaisePanel()" disabled>RAISE</button>
                <button class="btn btn-rebuy" id="reBuyBtn" onclick="reBuy()" style="display: none;">üí∞ RE-BUY</button>
                <button class="btn btn-allin" id="allinBtn" onclick="playerAction('allin')" disabled>ALL-IN</button>
                <button class="btn btn-leave" onclick="leaveRoom()">‚ùå √áIX</button>
            </div>
        </div>
    </div>

    <div class="raise-slider-panel" id="raiseSliderPanel">
        <div class="raise-slider-content">
            <div class="raise-amount-display" id="raiseAmountDisplay">$100</div>
            <div class="raise-slider-info">
                <div>Min: <span id="raiseMinAmount">20</span> | Max: <span id="raiseMaxAmount">1000</span></div>
            </div>
            <input type="range" id="raiseSlider" class="raise-slider" min="20" max="1000" step="10" value="100">
            <div class="raise-slider-buttons">
                <button class="btn-slider-ok" onclick="confirmRaise()">‚úì OK</button>
                <button class="btn-slider-cancel" onclick="closeRaisePanel()">‚úó CANCEL</button>
            </div>
        </div>
    </div>

    <script>
        let connection = null;
        let currentUserId = 0;
        let currentRoomId = null;
        let myHoleCards = [];
        let currentPlayerName = '';
        let currentGameType = 0;
        let currentBigBlind = 0;
        let currentPot = 0;
        let raiseSliderMin = 0;
        let raiseSliderMax = 1000;
        let rebuyCountdownInterval = null;

         let currentMinBuyIn = 0;
        let currentMaxBuyIn = 0;

        let currentReBuyMin = 0;
        let currentReBuyMax = 0;

        let turnTimeoutTimer = null;
        let currentTurnTimeRemaining = 0;



        document.addEventListener('DOMContentLoaded', async () => {
            await initializeSignalR();
            setupRaiseSlider();
        });

        document.addEventListener('DOMContentLoaded', () => {
            const buyInInput = document.getElementById('buyInInput');

            if (buyInInput) {
                // Input d…ôyi≈ü…ônd…ô validation et
                buyInInput.addEventListener('input', (e) => {
                    let value = parseFloat(e.target.value) || 0;

                    // Min/Max limitl…ôri uygula
                    if (value < currentMinBuyIn) {
                        value = currentMinBuyIn;
                    }
                    if (value > currentMaxBuyIn) {
                        value = currentMaxBuyIn;
                    }

                    e.target.value = value;
                    console.log(`üíµ Buy-in input: ${value}‚Çº`);
                });
            }
        });
        function setupRaiseSlider() {
            const slider = document.getElementById('raiseSlider');
            const display = document.getElementById('raiseAmountDisplay');
            slider.addEventListener('input', (e) => {
                display.textContent = ' + e.target.value';
            });
        }

        function openRaisePanel() {
            if (currentGameType === 1) {
                playerAction('raise', null);
                return;
            }
            const panel = document.getElementById('raiseSliderPanel');
            const slider = document.getElementById('raiseSlider');
            const display = document.getElementById('raiseAmountDisplay');

            slider.min = raiseSliderMin;
            slider.max = raiseSliderMax;
            slider.value = raiseSliderMin;
            display.textContent = ' + raiseSliderMin';

            document.getElementById('raiseMinAmount').textContent = raiseSliderMin;
            document.getElementById('raiseMaxAmount').textContent = raiseSliderMax;

            panel.classList.add('active');
        }

        function closeRaisePanel() {
            document.getElementById('raiseSliderPanel').classList.remove('active');
        }

        async function confirmRaise() {
            const amount = parseFloat(document.getElementById('raiseSlider').value);
            closeRaisePanel();
            await playerAction('raise', amount);
        }

        function getToken() {
            const raw = document.cookie.split("; ").find(row => row.startsWith("AuthToken="))?.split("=")[1];
            return raw ? decodeURIComponent(raw).trim() : "";
        }

        async function initializeSignalR() {
            try {
                connection = new signalR.HubConnectionBuilder()
                    .withUrl("/pokerhub", { accessTokenFactory: () => getToken() })
                    .withAutomaticReconnect()
                    .build();
                setupSignalRHandlers();
                await connection.start();
                console.log("‚úÖ Poker SignalR connected");
                await loadRoomList();
            } catch (error) {
                console.error("‚ùå SignalR connection error:", error);
                showMessage("Baƒülantƒ± x…ôtasƒ±: " + error.message, "error");
            }
        }

        function setupSignalRHandlers() {
            connection.on("UserData", (data) => {
                currentUserId = data.userId;
                currentPlayerName = data.fullName;
                document.getElementById('userName').textContent = data.fullName;
                document.getElementById('userBalance').textContent = data.balance.toFixed(2);
            });

            connection.on("BalanceUpdated", (balance) => {
                document.getElementById('userBalance').textContent = balance.toFixed(2);
                document.getElementById('gameBalance').textContent = balance.toFixed(2);
            });

            connection.on("JoinedRoom", (data) => {
                currentRoomId = data.roomId;

                window.currentRoomId = data.roomId;
                window.currentRoomInfo = {
                    roomId: data.roomId,
                    roomName: data.roomName,
                    entryFee: data.entryFee || data.minBuyIn || 10,
                    minBuyIn: data.minBuyIn,
                    maxBuyIn: data.maxBuyIn
                };

                document.getElementById('currentRoomName').textContent = data.roomName;
                document.getElementById('gameBalance').textContent = data.balance.toFixed(2);
                document.getElementById('playerChips').textContent = data.chips.toFixed(2);
                if (data.gameType !== undefined) {
                    currentGameType = data.gameType;
                    updateGameTypeDisplay();
                }

                document.getElementById('roomListSection').style.display = 'none';
                document.getElementById('gameSection').classList.add('active');
                showMessage("Otaƒüa qo≈üuldunuz!", "success");
            });

            connection.on("PlayerTimeout", (data) => {
                console.log(`‚è∞ Timeout: ${data.playerName}`);
                console.log(`üì¢ Message: ${data.message}`);

                if (data.playerName === currentPlayerName) {
                    // ‚úÖ √ñz√ºn√ºz√ºn timeout-u
                    showMessage(`‚è∞ Vaxtƒ±nƒ±z bitdi! Avtomatik FOLD olundu.`, "error");
                } else {
                    // ‚úÖ Ba≈üqasƒ±nƒ±n timeout-u
                    showMessage(`‚è∞ ${data.playerName} vaxt bitdi (Auto-fold)`, "info");
                }
            });
            connection.on("StreetAdvanced", (data) => {
                clearTimeout(turnTimeoutTimer);
                currentTurnTimeRemaining = 0;
                console.log("üé¥ New street - turn timer reset");
            });
            connection.on("JoinError", (message) => showMessage(message, "error"));
            connection.on("PlayerJoined", (playerName) => showMessage(playerName + " otaƒüa qo≈üuldu", "info"));
            connection.on("PlayerLeft", (playerName) => showMessage(playerName + " otaqdan √ßƒ±xdƒ±", "info"));
            connection.on("PlayerKicked", (playerName) => showMessage(playerName + " otaqdan √ßƒ±xarƒ±ldƒ±", "info"));

            connection.on("GameStarted", () => {
                const reBuyBtn = document.getElementById('reBuyBtn');
                reBuyBtn.style.display = 'none';
                reBuyBtn.disabled = true;
                showMessage("üéÆ Oyun ba≈üladƒ±!", "success");
            });

            connection.on("ShowReBuyOption", (seconds) => {
                const reBuyBtn = document.getElementById('reBuyBtn');
                reBuyBtn.style.display = 'inline-block';
                reBuyBtn.disabled = false;
                showMessage("üí∞ √áipl…ôr bitdi! Re-Buy edin", "info");
            });
            connection.on("ReBuyCountdown", (data) => {
                startReBuyCountdown(data.duration, data.playersWaiting);
            });
            connection.on("ReBuySuccess", (data) => {
                console.log("‚úÖ Re-buy successful:", data);

                const reBuyBtn = document.getElementById('reBuyBtn');
                reBuyBtn.style.display = 'none';
                reBuyBtn.disabled = true;

                showMessage(`‚úÖ ${data.amount}‚Çº …ôlav…ô edildi! Yeni √ßipl…ôr: ${data.chips}‚Çº`, "success");
                updatePlayerChips(data.chips);
                updateBalance(data.balance);
            });

            // üî• Re-buy Error event
            connection.on("ReBuyError", (message) => {
                console.error("‚ùå Re-buy error:", message);
                showMessage(message, "error");
            });

            connection.on("PlayerReBought", (playerName) => showMessage(`üí∞ ${playerName} re-buy etdi`, "info"));
            connection.on("WaitingForPlayers", (message) => showMessage(message, "info"));

            connection.on("KickedFromRoom", (reason) => {
                showMessage(reason, "error");
                document.getElementById('gameSection').classList.remove('active');
                document.getElementById('roomListSection').style.display = 'block';
                currentRoomId = null;
                currentGameType = 0;
                resetGameUI();
                loadRoomList();
            });

            connection.on("HoleCards", (cards) => {
                let cardArray = Array.isArray(cards) ? cards : Object.values(cards || {});
                if (cardArray && cardArray.length >= 2) {
                    myHoleCards = cardArray;
                    showMessage("üé¥ Kartlarƒ±nƒ±z g…ôldi!", "success");
                    // GameState yenil…ôm…ôsini g√∂zl…ô
                }
            });

            // SignalR event handlers
            connection.on("DisableActions", (data) => {
                // D√ºym…ôl…ôri deaktiv et
                document.querySelectorAll('.action-button').forEach(btn => {
                    btn.disabled = true;
                    btn.style.opacity = '0.5';
                });

                // Mesaj g√∂st…ôr
                showMessage(data.message, data.duration);
            });

            connection.on("EnableActions", () => {
                // D√ºym…ôl…ôri aktivl…ô≈üdir
                document.querySelectorAll('.action-button').forEach(btn => {
                    btn.disabled = false;
                    btn.style.opacity = '1';
                });
            });
            connection.on("DisableActionsFor", (seconds) => {
                console.log(`üö´ Actions disabled for ${seconds} seconds`);

                // B√ºt√ºn action d√ºym…ôl…ôrini disable et
                document.querySelectorAll('.action-button').forEach(btn => {
                    btn.disabled = true;
                    btn.style.opacity = '0.5';
                    btn.style.cursor = 'not-allowed';
                });

                // X saniy…ô sonra yenid…ôn aktiv et
                setTimeout(() => {
                    document.querySelectorAll('.action-button').forEach(btn => {
                        btn.disabled = false;
                        btn.style.opacity = '1';
                        btn.style.cursor = 'pointer';
                    });
                    console.log("‚úÖ Actions enabled after card reveal");
                }, seconds * 1000);
            });


            connection.on("GameState", (state) => {
                updateGameState(state);

                // ‚úÖ Cari oyun√ßunun turn time-ƒ± var mƒ±?
                if (state.players && state.players.length > 0) {
                    const myPlayer = state.players.find(p => p.name === currentPlayerName);

                    if (myPlayer && myPlayer.isActive && state.players[state.players.findIndex(p => p.name === currentPlayerName)].turnTimeRemaining > 0) {
                        const timeRemaining = state.players[state.players.findIndex(p => p.name === currentPlayerName)].turnTimeRemaining;

                        console.log(`‚è±Ô∏è Turn time remaining: ${timeRemaining}s`);

                        // ‚úÖ Auto-fold timer-i ba≈ülat
                        startAutoFoldTimer(timeRemaining);
                    }
                }
            });

            connection.on("StreetAdvanced", (data) => {
                        console.log(`üé¥ New street: ${data.street}`);
    
                        // üî• KARTLAR A√áILIR - D∆èRHAL D√úYM∆èL∆èR DEAKTƒ∞V OLSUN
                        disableAllActionButtons();
                        console.log("üö´ Buttons disabled - waiting for cards animation");
    
                        // Kartlarƒ± g√∂st…ôr
                        displayCommunityCards(data.communityCards);
    
                        // Street m…ôlumatƒ±nƒ± yenil…ô
                        currentStreet = data.street;
                        updateStreetDisplay(data.street);
                    });
            connection.on("PlayerActioned", (data) => {
                if (data.playerName === currentPlayerName && data.action.toLowerCase() === 'fold') {
                    const reBuyBtn = document.getElementById('reBuyBtn');
                    reBuyBtn.style.display = 'none';
                    reBuyBtn.disabled = true;
                }
            });


            connection.on("ShowdownCards", (allPlayerHands) => {
                displayShowdownOnTable(allPlayerHands);
            });

            connection.on("HideShowdownCards", () => {
                hideShowdownCards();
            });

            connection.on("GameOver", (data) => {
                showMessage(`üèÜ ${data.winner} qalib oldu!\n${data.handName}\n+${data.amount.toFixed(2)} AZN\nKomissiya: ${data.commission.toFixed(2)} AZN`, "success");
                setTimeout(() => createConfetti(), 500);
                disableActionButtons();
            });

            connection.on("HandReset", () => {
                const reBuyBtn = document.getElementById('reBuyBtn');
                reBuyBtn.style.display = 'none';
                reBuyBtn.disabled = true;
                resetGameUI();
                showMessage("Yeni …ôl √º√ß√ºn hazƒ±rdƒ±r", "info");
            });
            connection.on("LeftRoom", () => {
                document.getElementById('gameSection').classList.remove('active');
                document.getElementById('roomListSection').style.display = 'block';
                currentRoomId = null;
                currentGameType = 0;
                resetGameUI();
                loadRoomList();
            });

            connection.on("ActionError", (msg) => showMessage(msg, "error"));
            connection.on("Error", (msg) => showMessage(msg, "error"));
            connection.on("GameError", (msg) => showMessage(msg, "error"));
        }

        function startAutoFoldTimer(timeInSeconds) {
            // ‚úÖ K√∂hn…ô timer-i dayandƒ±r
            if (turnTimeoutTimer) {
                clearTimeout(turnTimeoutTimer);
            }

            currentTurnTimeRemaining = timeInSeconds;

            console.log(`‚è∞ Auto-fold timer ba≈üladƒ±: ${timeInSeconds}s`);

            // ‚úÖ Timeout-dan 1 saniy…ô …ôvv…ôl fold et
            const delayMs = (timeInSeconds - 1) * 1000; // 1s …ôvv…ôl

            turnTimeoutTimer = setTimeout(() => {
                executeAutoFold();
            }, delayMs);
        }
        async function executeAutoFold() {
            console.log("‚è∞ ‚è∞ ‚è∞ VAXT Bƒ∞TDƒ∞! AUTO-FOLD ICRA EDILIR!");

            // ‚úÖ FOLD D√úYM∆èSINI BAS
            const foldBtn = document.getElementById('foldBtn');

            if (foldBtn && !foldBtn.disabled) {
                console.log("‚úÖ Fold d√ºym…ô basƒ±lƒ±yor...");

                // R…ôngi d…ôyi≈ü (visual feedback)
                foldBtn.style.background = '#ef4444';
                foldBtn.style.boxShadow = '0 0 20px rgba(239, 68, 68, 1)';

                // D√ºym…ôyi bas
                foldBtn.click();

                // ‚úÖ Animasyon
                showMessage("‚è∞ Vaxt bitdi! AUTO-FOLD edildini", "info");

                console.log("‚úÖ Auto-fold tamamlandƒ±");
            } else {
                console.warn("‚ùå Fold d√ºym…ô m√∂vcud deyil v…ô ya deaktivdir");
            }
        }
        function updateTurnCountdown() {
            const gameState = document.querySelector('[data-turn-time]');

            if (currentTurnTimeRemaining > 0) {
                currentTurnTimeRemaining--;

                // ‚úÖ Timer display-i yenil…ô (…ôg…ôr var olarsa)
                const timerDisplay = document.getElementById('turnTimerDisplay');
                if (timerDisplay) {
                    timerDisplay.textContent = `${currentTurnTimeRemaining}s`;

                    // ‚è∞ Son 5 saniy…ôd…ô qƒ±rmƒ±zƒ± et
                    if (currentTurnTimeRemaining <= 5) {
                        timerDisplay.style.color = '#dc2626';
                        timerDisplay.style.textShadow = '0 0 10px rgba(220, 38, 38, 1)';
                    } else {
                        timerDisplay.style.color = '#4ade80';
                        timerDisplay.style.textShadow = '0 0 10px rgba(74, 222, 128, 1)';
                    }
                }
            }
        }

        function updatePlayerChips(chips) {
            const chipsElement = document.getElementById('playerChips');
            if (chipsElement) {
                chipsElement.textContent = chips.toFixed(2) + '‚Çº';
            }
        }

        function updateBalance(balance) {
            const balanceElement = document.getElementById('userBalance');
            if (balanceElement) {
                balanceElement.textContent = balance.toFixed(2) + '‚Çº';
            }
        }

        function showMessage(message, type) {
            // M√∂vcud showMessage funksiyasƒ± v…ô ya sad…ô alert
            console.log(`${type === 'error' ? '‚ùå' : '‚úÖ'} ${message}`);
            alert(message);
        }

        function startReBuyCountdown(duration, playersWaiting) {
            if (rebuyCountdownInterval) {
                clearInterval(rebuyCountdownInterval);
            }

            const banner = document.getElementById('rebuyCountdownBanner');
            const timer = document.getElementById('rebuyCountdownTimer');
            const waitingList = document.getElementById('rebuyWaitingPlayers');

            waitingList.textContent = 'G√∂zl…ôy…ôn: ' + playersWaiting.join(', ');
            banner.classList.add('active');

            let remaining = duration;
            timer.textContent = remaining;

            rebuyCountdownInterval = setInterval(() => {
                remaining--;
                timer.textContent = remaining;
                if (remaining <= 0) {
                    clearInterval(rebuyCountdownInterval);
                    banner.classList.remove('active');
                }
            }, 1000);
        }

        function displayShowdownOnTable(allPlayerHands) {
            allPlayerHands.forEach(ph => {
                const playerSpots = document.querySelectorAll('.player-spot');
                playerSpots.forEach(spot => {
                    const playerName = spot.querySelector('.player-name')?.textContent?.replace('üîµ ', '');
                    if (playerName === ph.playerName) {
                        const avatar = spot.querySelector('.player-avatar');
                        if (ph.isWinner && avatar) {
                            avatar.classList.add('winner');
                        }

                        let showdownContainer = spot.querySelector('.showdown-cards');
                        if (!showdownContainer) {
                            showdownContainer = document.createElement('div');
                            showdownContainer.className = 'showdown-cards';
                            spot.appendChild(showdownContainer);
                        }

                        const cardsHtml = ph.cards.map(card => {
                            const isRed = card.includes('‚ô•') || card.includes('‚ô¶');
                            const rank = card.slice(0, -1);
                            const suit = card.slice(-1);
                            return `<div class="mini-card-showdown ${isRed ? 'red' : 'black'}">
                                            <div style="font-size: 1rem;">${rank}</div>
                                            <div style="font-size: 1.3rem;">${suit}</div>
                                        </div>`;
                        }).join('');

                        showdownContainer.innerHTML = cardsHtml;
                        setTimeout(() => showdownContainer.classList.add('visible'), 100);

                        let handNameEl = spot.querySelector('.showdown-hand-name');
                        if (!handNameEl) {
                            handNameEl = document.createElement('div');
                            handNameEl.className = 'showdown-hand-name';
                            spot.appendChild(handNameEl);
                        }
                        handNameEl.textContent = ph.handName || '';
                        setTimeout(() => handNameEl.classList.add('visible'), 100);
                    }
                });
            });
        }

        function hideShowdownCards() {
            document.querySelectorAll('.showdown-cards').forEach(el => {
                el.classList.remove('visible');
                setTimeout(() => el.remove(), 500);
            });
            document.querySelectorAll('.showdown-hand-name').forEach(el => {
                el.classList.remove('visible');
                setTimeout(() => el.remove(), 500);
            });
            document.querySelectorAll('.player-avatar.winner').forEach(el => {
                el.classList.remove('winner');
            });
        }

        function updateGameTypeDisplay() {
            const icon = document.getElementById('gameTypeIcon');
            const desc = document.getElementById('gameTypeDescription');
            switch (currentGameType) {
                case 0:
                    icon.textContent = 'üî¥';
                    desc.textContent = 'No-Limit Texas Hold\'em - Limitsiz m…ôrc';
                    break;
                case 1:
                    icon.textContent = 'üü¢';
                    desc.textContent = 'Limit Texas Hold\'em - Sabit m…ôrc limitl…ôri';
                    break;
                case 2:
                    icon.textContent = 'üü°';
                    desc.textContent = 'Pot-Limit - Maksimum m…ôrc = Pot q…ôd…ôr';
                    break;
            }
        }

        async function loadRoomList() {
            try {
                const rooms = await connection.invoke("GetRoomList");
                displayRoomList(rooms);
            } catch (error) {
                console.error("Room list error:", error);
            }
        }

        function displayRoomList(rooms) {
            const grid = document.getElementById('roomGrid');
            if (!rooms || rooms.length === 0) {
                grid.innerHTML = '<div style="text-align: center; padding: 40px;">Hazƒ±rda aktiv otaq yoxdur</div>';
                return;
            }
            const getGameTypeBadge = (type) => {
                switch (type) {
                    case 0: return '<span class="game-type-badge badge-no-limit">üî¥ NO-LIMIT</span>';
                    case 1: return '<span class="game-type-badge badge-limit">üü¢ LIMIT</span>';
                    case 2: return '<span class="game-type-badge badge-pot-limit">üü° POT-LIMIT</span>';
                    default: return '';
                }
            };
            grid.innerHTML = rooms.map(room => `
                    <div class="room-card" onclick="joinRoom('${room.roomId}')">
                        ${getGameTypeBadge(room.gameType)}
                        <h3>${room.roomName}</h3>
                        <div class="room-info">
                            <div>üë• Oyun√ßular: ${room.playerCount}/${room.maxPlayers}</div>
                            <div>üí∞ Buy-in: ${room.buyIn} AZN</div>
                            <div>üé≤ Blinds: ${room.smallBlind}/${room.bigBlind}</div>
                            <div>üìç ${room.isGameActive ? 'üéÆ Oyun davam edir' : '‚úÖ G√∂zl…ôyir'}</div>
                        </div>
                        <button class="join-btn" onclick="event.stopPropagation(); joinRoom('${room.roomId}')">üéØ QO≈ûUL</button>
                    </div>
                `).join('');
        }

     

        async function joinRoom(roomId) {
            try {
                currentRoomId = roomId;

                console.log(`üîç Getting room info for: ${roomId}`);

                // Room m…ôlumatlarƒ±nƒ± al
                const roomInfo = await connection.invoke("GetRoomInfo", roomId);

                console.log("üìä Room info received:", roomInfo);

                if (roomInfo) {
                    // ‚úÖ D√úZ∆èLƒ∞≈û: Backend-d…ôn g…ôl…ôn d…ôy…ôrl…ôri istifad…ô et
                    currentMinBuyIn = roomInfo.minBuyIn || roomInfo.entryFee;
                    currentMaxBuyIn = roomInfo.maxBuyIn || (roomInfo.entryFee * 100);

                    console.log(`üí∞ Buy-in range: ${currentMinBuyIn}‚Çº - ${currentMaxBuyIn}‚Çº`);

                    document.getElementById('minBuyIn').textContent = currentMinBuyIn.toFixed(2);
                    document.getElementById('maxBuyIn').textContent = currentMaxBuyIn.toFixed(2);
                    document.getElementById('buyInInput').value = currentMinBuyIn; // Default minimum
                    document.getElementById('buyInInput').min = currentMinBuyIn;
                    document.getElementById('buyInInput').max = currentMaxBuyIn;
                    document.getElementById('buyInInput').step = roomInfo.bigBlind || 1;

                    // Modal-ƒ± g√∂st…ôr
                    document.getElementById('buyInModal').style.display = 'flex';
                } else {
                    showMessage("Room m…ôlumatƒ± tapƒ±lmadƒ±", "error");
                }
            } catch (error) {
                console.error("‚ùå joinRoom error:", error);
                showMessage("Room m…ôlumatƒ± alƒ±na bilm…ôdi: " + error.message, "error");
            }
        }

        // Hazƒ±r m…ôbl…ôƒül…ôr
        function setQuickBuyIn(type) {
            const input = document.getElementById('buyInInput');

            if (!input) {
                console.error("‚ùå Input field tapƒ±lmadƒ±");
                return;
            }

            let value = 0;

            if (type === 'min') {
                value = currentMinBuyIn;
            } else if (type === 'mid') {
                value = Math.round((currentMinBuyIn + currentMaxBuyIn) / 2);
            } else if (type === 'max') {
                value = currentMaxBuyIn;
            }

            // ‚úÖ D√úZ∆èLƒ∞≈û: Input-un value-sunu d…ôyi≈ü
            input.value = value;

            console.log(`‚úÖ Quick buy-in set: ${value}‚Çº (${type})`);

            // Visual feedback
            input.style.borderColor = '#10b981';
            setTimeout(() => {
                input.style.borderColor = '#334155';
            }, 300);
        }

        // Buy-in t…ôsdiqi
        async function confirmBuyIn() {
            const buyInAmount = parseFloat(document.getElementById('buyInInput').value);

            console.log(`üéØ Confirming buy-in: ${buyInAmount}‚Çº for room: ${currentRoomId}`);

            // ‚úÖ Validasiyalar
            if (isNaN(buyInAmount) || buyInAmount <= 0) {
                showMessage("D√ºzg√ºn m…ôbl…ôƒü daxil edin!", "error");
                return;
            }

            if (buyInAmount < currentMinBuyIn) {
                showMessage(`Minimum buy-in: ${currentMinBuyIn}‚Çº`, "error");
                return;
            }

            if (buyInAmount > currentMaxBuyIn) {
                showMessage(`Maksimum buy-in: ${currentMaxBuyIn}‚Çº`, "error");
                return;
            }

            // üî• roomId-ni saxla
            const roomIdToJoin = currentRoomId;

            if (!roomIdToJoin) {
                showMessage("Room ID tapƒ±lmadƒ±", "error");
                return;
            }

            try {
                console.log(`üöÄ Joining room ${roomIdToJoin} with ${buyInAmount}‚Çº`);

                // Modal-ƒ± baƒüla
                closeBuyInModal();

                // Otaƒüa qo≈üul
                await connection.invoke("JoinRoom", roomIdToJoin, buyInAmount);

                console.log("‚úÖ Successfully joined room");

            } catch (error) {
                console.error("‚ùå JoinRoom error:", error);
                showMessage("Otaƒüa qo≈üula bilm…ôdiniz: " + error.message, "error");
            }
        }

        // Modal-ƒ± baƒüla
        function closeBuyInModal() {
            const modal = document.getElementById('buyInModal');
            if (modal) {
                modal.style.display = 'none';
            }

            // Input-u t…ômizl…ô
            const input = document.getElementById('buyInInput');
            if (input) {
                input.value = '';
            }

            // roomId-ni sƒ±fƒ±rla
            setTimeout(() => {
                currentRoomId = null;
            }, 100);

            console.log("‚ùå Buy-in modal closed");
        }



        async function showReBuyModal() {
            try {
                // ∆èvv…ôlc…ô cari room ID-ni al
                const roomId = getCurrentRoomId(); // Bu funksiya olmalƒ±dƒ±r

                if (!roomId) {
                    showMessage("Otaq m…ôlumatƒ± tapƒ±lmadƒ±", "error");
                    return;
                }

                // üî• VARIANT 1: window.currentRoomInfo saxlanƒ±bsa (t√∂vsiy…ô)
                if (window.currentRoomInfo) {
                    currentReBuyMin = window.currentRoomInfo.entryFee;
                    currentReBuyMax = window.currentRoomInfo.entryFee * 50;

                    console.log(`‚úÖ Using cached room info: ${currentReBuyMin}‚Çº - ${currentReBuyMax}‚Çº`);
                }
                // üî• VARIANT 2: Room m…ôlumatƒ±nƒ± backend-d…ôn al
                else {
                    console.log("üì° Fetching room info from backend...");
                    const roomInfo = await connection.invoke("GetRoomInfo", roomId);

                    if (roomInfo) {
                        currentReBuyMin = roomInfo.entryFee;
                        currentReBuyMax = roomInfo.entryFee * 50;

                        // M…ôlumatƒ± saxla (n√∂vb…ôti d…ôf…ô √º√ß√ºn)
                        window.currentRoomInfo = {
                            roomId: roomInfo.roomId,
                            roomName: roomInfo.roomName,
                            entryFee: roomInfo.entryFee,
                            minBuyIn: roomInfo.minBuyIn,
                            maxBuyIn: roomInfo.maxBuyIn
                        };

                        console.log(`‚úÖ Fetched room info: ${currentReBuyMin}‚Çº - ${currentReBuyMax}‚Çº`);
                    } else {
                        // ∆èg…ôr he√ß n…ô alƒ±nmadƒ±sa, default d…ôy…ôrl…ôr
                        currentReBuyMin = 10;
                        currentReBuyMax = 500;
                        console.warn("‚ö†Ô∏è Using default re-buy values");
                    }
                }

                // Modal-ƒ± doldur
                document.getElementById('reBuyMinAmount').textContent = currentReBuyMin;
                document.getElementById('reBuyMaxAmount').textContent = currentReBuyMax;
                document.getElementById('reBuyInput').value = currentReBuyMin;
                document.getElementById('reBuyInput').min = currentReBuyMin;
                document.getElementById('reBuyInput').max = currentReBuyMax;

                // Modal-ƒ± g√∂st…ôr
                document.getElementById('reBuyModal').style.display = 'flex';

                console.log(`üîÑ Re-buy modal opened (${currentReBuyMin}‚Çº - ${currentReBuyMax}‚Çº)`);

            } catch (error) {
                console.error("‚ùå showReBuyModal error:", error);
                showMessage("Re-buy modal a√ßƒ±la bilm…ôdi", "error");
            }
        }

        // Hazƒ±r re-buy m…ôbl…ôƒül…ôri
        function setQuickReBuy(type) {
            const input = document.getElementById('reBuyInput');

            if (type === 'min') {
                input.value = currentReBuyMin;
            } else if (type === 'mid') {
                input.value = Math.round((currentReBuyMin + currentReBuyMax) / 2);
            } else if (type === 'max') {
                input.value = currentReBuyMax;
            }

            console.log(`üíµ Quick re-buy selected: ${input.value}‚Çº (${type})`);
        }

        // Re-buy t…ôsdiqi
        async function confirmReBuy() {
            const reBuyAmount = parseFloat(document.getElementById('reBuyInput').value);

            console.log(`üéØ Confirming re-buy: ${reBuyAmount}‚Çº`);

            // Validasiyalar
            if (isNaN(reBuyAmount)) {
                showMessage("D√ºzg√ºn m…ôbl…ôƒü daxil edin", "error");
                return;
            }

            if (reBuyAmount < currentReBuyMin) {
                showMessage(`Minimum re-buy: ${currentReBuyMin}‚Çº`, "error");
                return;
            }

            if (reBuyAmount > currentReBuyMax) {
                showMessage(`Maksimum re-buy: ${currentReBuyMax}‚Çº`, "error");
                return;
            }

            // Modal-ƒ± baƒüla
            closeReBuyModal();

            try {
                console.log(`üöÄ Re-buying ${reBuyAmount}‚Çº`);
                await connection.invoke("ReBuy", reBuyAmount);
                console.log("‚úÖ Re-buy request sent");
            } catch (error) {
                console.error("‚ùå ReBuy error:", error);
                showMessage("Re-buy alƒ±nmadƒ±: " + error.message, "error");
            }
        }

        // Re-buy modal-ƒ±nƒ± baƒüla
        function closeReBuyModal() {
            document.getElementById('reBuyModal').style.display = 'none';
            console.log("‚ùå Re-buy modal closed");
        }
        function getCurrentRoomId() {
            // ∆èg…ôr global d…ôyi≈ü…ôn varsa
            if (window.currentRoomId) {
                return window.currentRoomId;
            }

            // ∆èg…ôr currentRoomInfo-da saxlanƒ±bsa
            if (window.currentRoomInfo && window.currentRoomInfo.roomId) {
                return window.currentRoomInfo.roomId;
            }

            console.warn("‚ö†Ô∏è Room ID not found");
            return null;
        }

        async function leaveRoom() {
            if (!confirm("Otaqdan √ßƒ±xmaq ist…ôdiyiniz…ô …ôminsiniz?")) return;
            try {
                await connection.invoke("LeaveRoom");
            } catch (error) {
                showMessage("X…ôta ba≈ü verdi", "error");
            }
        }

        async function playerAction(action, amount = null) {
            clearTimeout(turnTimeoutTimer);
            currentTurnTimeRemaining = 0;
            if (action === 'raise' && currentGameType !== 1 && !amount) {
                openRaisePanel();
                return;
            }
            try {
                await connection.invoke("PlayerAction", action, amount);
            } catch (error) {
                showMessage("X…ôta: " + error.message, "error");
            }
        }

        async function reBuy() {
            try {
                // Birba≈üa ReBuy √ßaƒüƒ±rƒ±mƒ± yerin…ô modal a√ß
                await showReBuyModal();
            } catch (error) {
                showMessage("Re-buy x…ôtasƒ±: " + error.message, "error");
            }
        }

        const reBuyButtonStyle = `
            .btn-rebuy {
                background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
                color: #fff;
                animation: rebuyPulse 2s infinite;
                box-shadow: 0 0 20px rgba(245, 158, 11, 0.6);
            }

            .btn-rebuy:disabled {
                opacity: 0.5;
                cursor: not-allowed;
                animation: none;
            }

            @keyframes rebuyPulse {
                0%, 100% {
                    box-shadow: 0 0 20px rgba(245, 158, 11, 0.6);
                }
                50% {
                    box-shadow: 0 0 40px rgba(245, 158, 11, 1);
                }
            }
            `;

        function displayHoleCards() {
            // Kartlar indi player-spot-da g√∂st…ôrilir
            // Bu funksiyanƒ± yenil…ôyirik
            if (myHoleCards && myHoleCards.length > 0) {
                updatePlayersOnTable(
                    document.querySelectorAll('.player-spot').length > 0 ?
                        Array.from(document.querySelectorAll('.player-spot')).map(spot => ({
                            name: spot.dataset.playerName
                        })) : [],
                    0
                );
            }
        }

        function displayCommunityCards(cards) {
            const container = document.getElementById('communityCards');
            if (!cards || cards.length === 0) {
                container.innerHTML = '';
                return;
            }
            container.innerHTML = cards.map(card => {
                const isRed = card.includes('‚ô•') || card.includes('‚ô¶');
                const rank = card.slice(0, -1);
                const suit = card.slice(-1);
                return `<div class="mini-card ${isRed ? 'red' : 'black'}">
                        <div style="font-size: 1.2rem;">${rank}</div>
                        <div style="font-size: 1.5rem;">${suit}</div>
                    </div>`;
            }).join('');
        }

        function updateGameState(state) {
            if (!state || !state.players) return;

            const myPlayer = state.players.find(p => p.name === currentPlayerName);
            const currentPlayer = state.players[0]; // F…ôrz et ki, active oyun√ßu birinci

            // ‚úÖ Timer display-i g√∂st…ôr/gizl…ô
            const timerDisplay = document.getElementById('turnTimerDisplay');
            if (timerDisplay) {
                if (currentPlayer && currentPlayer.isActive) {
                    timerDisplay.style.display = 'block';
                    timerDisplay.textContent = `${currentPlayer.turnTimeRemaining || 0}s`;

                    // ‚è∞ Son 5 saniy…ôd…ô qƒ±rmƒ±zƒ± et
                    if ((currentPlayer.turnTimeRemaining || 0) <= 5) {
                        timerDisplay.style.color = '#dc2626';
                        timerDisplay.style.textShadow = '0 0 10px rgba(220, 38, 38, 1)';
                        timerDisplay.style.borderColor = '#dc2626';
                    } else {
                        timerDisplay.style.color = '#4ade80';
                        timerDisplay.style.textShadow = '0 0 10px rgba(74, 222, 128, 1)';
                        timerDisplay.style.borderColor = '#4ade80';
                    }
                } else {
                    timerDisplay.style.display = 'none';
                }
            }

            // ‚úÖ Siz sƒ±rada olsunuz
            if (myPlayer && myPlayer.isActive && myPlayer.turnTimeRemaining > 0) {
                startAutoFoldTimer(myPlayer.turnTimeRemaining);
            }
            document.getElementById('potAmount').textContent = (state.pot || 0).toFixed(2);
            document.getElementById('currentBet').textContent = (state.currentBet || 0).toFixed(2);
            currentPot = state.pot || 0;
            currentBigBlind = state.bigBlind || 0;

            if (state.gameType !== undefined) {
                currentGameType = state.gameType;
            }

            if (state.communityCards) displayCommunityCards(state.communityCards);
            if (state.players) updatePlayersOnTable(state.players, state.dealerIndex || 0);

             if (!myPlayer) return;

            document.getElementById('playerChips').textContent = myPlayer.chips.toFixed(2);

            // üî¥ RE-BUY D√úYM∆è KONTROL
            const reBuyBtn = document.getElementById('reBuyBtn');
            if (myPlayer.chips <= 0 && !myPlayer.hasFolded) {
                // √áipl…ôr bitdi V∆è fold etm…ôdiyiniz
                reBuyBtn.style.display = 'inline-block';
                reBuyBtn.disabled = false;
            } else {
                // Oyun zamanƒ± v…ô ya fold-da - Gƒ∞ZL∆è ET
                reBuyBtn.style.display = 'none';
                reBuyBtn.disabled = true;
            }
            const activePlayers = state.players.filter(p => p.isInHand && !p.hasFolded);
            const isLastPlayer = activePlayers.length === 1 && activePlayers[0].name === currentPlayerName;
            const isMyTurn = myPlayer.isActive && myPlayer.isInHand && !myPlayer.hasFolded;
            const needToCall = state.currentBet > myPlayer.currentBet;
            const callAmount = state.currentBet - myPlayer.currentBet;

            const callBtn = document.getElementById('callBtn');
            const callAmountSpan = document.getElementById('callAmount');
            if (needToCall && callAmount > 0) {
                callAmountSpan.textContent = `(${callAmount.toFixed(2)})`;
            } else {
                callAmountSpan.textContent = '';
            }

            document.getElementById('foldBtn').disabled = !isMyTurn || isLastPlayer;
            callBtn.disabled = !isMyTurn || !needToCall;
            document.getElementById('checkBtn').disabled = !isMyTurn || needToCall;
            document.getElementById('raiseBtn').disabled = !isMyTurn;

            const minRaise = Math.max(state.currentBet * 2, currentBigBlind * 2);
            const maxRaise = currentGameType === 2 ? currentPot + state.currentBet : myPlayer.chips;
            raiseSliderMin = minRaise;
            raiseSliderMax = maxRaise;

            const allinBtn = document.getElementById('allinBtn');
            if (currentGameType === 1) {
                allinBtn.style.display = 'none';
            } else {
                allinBtn.style.display = 'inline-block';
                allinBtn.disabled = !isMyTurn;
            }
        }

        window.addEventListener('beforeunload', () => {
            if (turnTimeoutTimer) {
                clearTimeout(turnTimeoutTimer);
            }
        });
        function updatePlayersOnTable(players, dealerIndex) {
            const table = document.getElementById('pokerTable');
            const existingSpots = table.querySelectorAll('.player-spot');
            existingSpots.forEach(spot => spot.remove());

            if (!players || players.length === 0) return;

            // Cari oyun√ßunu tap
            const myIndex = players.findIndex(p => p.name === currentPlayerName);
            if (myIndex === -1) return;

            // Pozisiyalar: cari oyun√ßu h…ômi≈ü…ô bottom-da
            const positions = ['bottom', 'left', 'top-left', 'top', 'top-right', 'right', 'bottom-right', 'bottom-left'];

            // Oyun√ßularƒ± yenid…ôn sƒ±rala ki, cari oyun√ßu 0-cƒ± indeksd…ô olsun
            const reorderedPlayers = [
                ...players.slice(myIndex),
                ...players.slice(0, myIndex)
            ];

            // Dealer indeksini yenid…ôn hesabla
            const newDealerIndex = (dealerIndex - myIndex + players.length) % players.length;

            reorderedPlayers.forEach((player, index) => {
                if (index >= positions.length) return;
                const spot = document.createElement('div');
                spot.className = `player-spot ${positions[index]}`;
                spot.dataset.playerName = player.name;
                const isDealer = index === newDealerIndex;
                const activeClass = player.isActive && !player.hasFolded ? 'active' : '';
                const foldedClass = player.hasFolded ? 'folded' : '';

                // Kartlarƒ± g√∂st…ôr (yalnƒ±z cari oyun√ßu √º√ß√ºn v…ô ya showdown zamanƒ±)
                let cardsHtml = '';
                if (index === 0 && myHoleCards && myHoleCards.length > 0) {
                    // Cari oyun√ßunun kartlarƒ±
                    cardsHtml = '<div class="player-cards">';
                    myHoleCards.forEach(card => {
                        const isRed = card.includes('‚ô•') || card.includes('‚ô¶');
                        const rank = card.slice(0, -1);
                        const suit = card.slice(-1);
                        cardsHtml += `<div class="player-card ${isRed ? 'red' : 'black'}">
                                <div style="font-size: 1rem;">${rank}</div>
                                <div style="font-size: 1.3rem;">${suit}</div>
                            </div>`;
                    });
                    cardsHtml += '</div>';
                }

                spot.innerHTML = `
                        <div class="player-avatar ${foldedClass} ${activeClass}">
                            ${player.name ? player.name.charAt(0).toUpperCase() : '?'}
                        </div>
                        <div class="player-name">${isDealer ? 'üîµ ' : ''}${player.name || 'Bo≈ü'}</div>
                        <div class="player-chips">${(player.chips || 0).toFixed(2)} chips</div>
                        ${player.currentBet > 0 ? `<div class="player-bet">M…ôrc: ${player.currentBet.toFixed(2)}</div>` : ''}
                        ${player.hasFolded ? '<div class="player-status">FOLD</div>' : ''}
                        ${cardsHtml}
                    `;
                table.appendChild(spot);
            });
        }

        function disableActionButtons() {
            document.getElementById('foldBtn').disabled = true;
            document.getElementById('callBtn').disabled = true;
            document.getElementById('checkBtn').disabled = true;
            document.getElementById('raiseBtn').disabled = true;
            document.getElementById('allinBtn').disabled = true;
            const callAmountSpan = document.getElementById('callAmount');
            if (callAmountSpan) callAmountSpan.textContent = '';
            closeRaisePanel();
        }

        function resetGameUI() {
            myHoleCards = [];
            document.getElementById('communityCards').innerHTML = '';
            document.getElementById('potAmount').textContent = '0';
            document.getElementById('currentBet').textContent = '0';
            disableActionButtons();
            closeRaisePanel();
            hideShowdownCards();
            if (rebuyCountdownInterval) {
                clearInterval(rebuyCountdownInterval);
                document.getElementById('rebuyCountdownBanner').classList.remove('active');
            }
        }

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = ['#ffd700', '#4ade80', '#3b82f6', '#f59e0b'][Math.floor(Math.random() * 4)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        function showMessage(text, type = 'info') {
            const existing = document.querySelectorAll('.message');
            existing.forEach(msg => msg.remove());
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            document.body.appendChild(message);
            setTimeout(() => {
                message.style.animation = 'slideInRight 0.3s ease-out reverse';
                setTimeout(() => message.remove(), 300);
            }, 4000);
        }

        window.addEventListener('beforeunload', async () => {
            if (currentRoomId && connection) {
                try {
                    await connection.invoke("LeaveRoom");
                } catch (error) {
                    console.error("Error leaving room:", error);
                }
            }
        });

        setInterval(() => {
            if (!currentRoomId && document.getElementById('roomListSection').style.display !== 'none') {
                loadRoomList();
            }
        }, 10000);
    </script>
</body>
</html>