<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Durak - Card Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.min.js"></script>
    <link rel="stylesheet" href="./Durak.css">
</head>

<body>
    <!-- Luxe casino-style loading screen -->
    <div id="durakLoader" class="durak-loader">
        <div class="loader-inner">
            <div class="loader-title" data-i18n="loader_title">DURAK</div>
            <div class="loader-subtitle" data-i18n="loader_subtitle">Shuffling decks ‚Ä¢ Seating players</div>
            <div class="loader-table">
                <div class="loader-card-fan">
                    <div class="loader-card loader-card-red">
                        <div class="loader-card-corner top-left">
                            <span class="rank">A</span>
                            <span class="suit">‚ô•</span>
                        </div>
                        <div class="loader-card-center">‚ô•</div>
                        <div class="loader-card-corner bottom-right">
                            <span class="rank">A</span>
                            <span class="suit">‚ô•</span>
                        </div>
                    </div>
                    <div class="loader-card loader-card-black">
                        <div class="loader-card-corner top-left">
                            <span class="rank">K</span>
                            <span class="suit">‚ô†</span>
                        </div>
                        <div class="loader-card-center">‚ô†</div>
                        <div class="loader-card-corner bottom-right">
                            <span class="rank">K</span>
                            <span class="suit">‚ô†</span>
                        </div>
                    </div>
                    <div class="loader-card loader-card-red">
                        <div class="loader-card-corner top-left">
                            <span class="rank">Q</span>
                            <span class="suit">‚ô¶</span>
                        </div>
                        <div class="loader-card-center">‚ô¶</div>
                        <div class="loader-card-corner bottom-right">
                            <span class="rank">Q</span>
                            <span class="suit">‚ô¶</span>
                        </div>
                    </div>
                    <div class="loader-card loader-card-black">
                        <div class="loader-card-corner top-left">
                            <span class="rank">J</span>
                            <span class="suit">‚ô£</span>
                        </div>
                        <div class="loader-card-center">‚ô£</div>
                        <div class="loader-card-corner bottom-right">
                            <span class="rank">J</span>
                            <span class="suit">‚ô£</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="loader-progress"></div>
            <div class="loader-ticker">
                <span class="pulse-dot"></span>
                <span data-i18n="loader_status">Game is loading...</span>
            </div>
        </div>
    </div>

    <div class="messages" id="messages"></div>

    <div class="container">
        <div class="header">
            <button class="back-btn" onclick="backToGames()">
                ‚Üê
            </button>
            <h1 class="header-title" data-i18n="header_title">DURAK</h1>
            <div class="user-info" id="userInfo">
                <span id="userBalance">0</span>
            </div>
        </div>

        <!-- Lobby Screen -->
        <div class="lobby-screen" id="lobbyScreen">
            <div class="player-select-section">
                <!-- <h2>‚ö° Oyun N√∂v√º Se√ßin</h2> -->
                <div class="player-options">
                    <div class="player-option" data-count="2" onclick="selectPlayerCount(2)">
                        <div class="player-count">2</div>
                        <div class="player-label" data-i18n="player_label">Player</div>
                    </div>
                    <div class="player-option" data-count="3" onclick="selectPlayerCount(3)">
                        <div class="player-count">3</div>
                        <div class="player-label" data-i18n="player_label">Player</div>
                    </div>
                    <div class="player-option" data-count="4" onclick="selectPlayerCount(4)">
                        <div class="player-count">4</div>
                        <div class="player-label" data-i18n="player_label">Player</div>
                    </div>
                    <div class="player-option" data-count="6" onclick="selectPlayerCount(6)">
                        <div class="player-count">6</div>
                        <div class="player-label" data-i18n="player_label">Player</div>
                    </div>
                </div>
            </div>

            <!-- Room options panel (deck size, bet, modes, start) -->
            <div class="room-options-panel" id="roomOptionsPanel" style="display:none;">
                <h2 data-i18n="room_options_title">Room Settings</h2>
                <div class="deck-size-row">
                    <div class="deck-pill" data-size="24" onclick="toggleDeckSize(24)">24</div>
                    <div class="deck-pill selected" data-size="36" onclick="toggleDeckSize(36)">36</div>
                    <div class="deck-pill" data-size="52" onclick="toggleDeckSize(52)">52</div>
                </div>

                <div class="bet-row">
                    <label data-i18n="bet_label">Bet Selection</label>
                    <div class="bet-presets">
                        <button class="bet-btn" onclick="selectBet(0.2)">0.2</button>
                        <button class="bet-btn" onclick="selectBet(0.5)">0.5</button>
                        <button class="bet-btn" onclick="selectBet(1)">1</button>
                        <button class="bet-btn" onclick="selectBet(2)">2</button>
                        <button class="bet-btn" onclick="selectBet(5)">5</button>
                        <button class="bet-btn" onclick="selectBet(10)">10</button>
                        <button class="bet-btn" onclick="selectBet(20)">20</button>
                        <button class="bet-btn" onclick="selectBet(50)">50</button>
                        <button class="bet-btn" onclick="selectBet(100)">100</button>
                    </div>
                </div>

                <div class="modes-row">
                    <label data-i18n="modes_label">Game Modes</label>
                    <div class="modes-grid">
                        <div class="mode-col">
                            <!-- <div class="mode-title">S√ºtun 1</div> -->
                            <div class="mode-card selected" data-col="1" data-value="atilan"
                                onclick="selectMode(1,'atilan')" data-i18n="mode_atilan">Discarded</div>
                            <div class="mode-card" data-col="1" data-value="pas" onclick="selectMode(1,'pas')"
                                data-i18n="mode_pas">Pass</div>
                        </div>
                        <div class="mode-col">
                            <!-- <div class="mode-title">S√ºtun 2</div> -->
                            <div class="mode-card selected" data-col="2" data-value="qonsular"
                                onclick="selectMode(2,'qonsular')" data-i18n="mode_qonsular">Neighbors</div>
                            <div class="mode-card" data-col="2" data-value="hamisi" onclick="selectMode(2,'hamisi')"
                                data-i18n="mode_hamisi">All</div>
                        </div>
                    </div>
                </div>

                <div class="start-row">
                    <button class="btn btn-success" onclick="startMatch()" data-i18n="start">Start</button>
                    <button class="btn btn-sm" onclick="goBackToPlayerSelect()" data-i18n="back">‚Üê Back</button>
                </div>
            </div>

            <div class="quick-rooms-section" id="roomsSection" style="display:none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="margin: 0;" data-i18n="ready_rooms">üéÆ Ready Rooms</h2>
                    <button class="btn btn-sm" onclick="goBackToPlayerSelect()"
                        style="width: auto; padding: 10px 20px;">
                        <span data-i18n="back">‚Üê Back</span>
                    </button>
                </div>
                <p style="opacity: 0.8; margin-bottom: 20px;" data-i18n="join_room_hint">Join one of the rooms below</p>
                <div class="rooms-grid" id="quickRoomsList">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p data-i18n="rooms_loading">Loading rooms...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div class="game-screen" id="gameScreen">
            <div class="game-container">
                <div class="game-header">
                    <div class="game-info">
                        <div class="info-item">
                            <div class="label" data-i18n="prize_pool">Prize Pool</div>
                            <div class="value" id="totalPrize">0 AZN</div>
                        </div>
                        <div class="info-item">
                            <div class="label" data-i18n="room">Room</div>
                            <div class="value" id="currentRoomName">-</div>
                        </div>
                        <div class="info-item">
                            <div class="label" data-i18n="in_deck">In Deck</div>
                            <div class="value" id="deckCount">36</div>
                        </div>
                    </div>
                    <div class="game-actions">
                        <button class="btn btn-sm btn-success hidden" id="beatenBtn" data-i18n="beaten">‚úÖ Beaten</button>
                        <button class="btn btn-sm btn-danger hidden" id="takeCardsBtn" data-i18n="take_cards">üì• Take Cards</button>
                        <button class="btn btn-sm btn-danger" id="leaveRoomBtn" data-i18n="leave_room">Leave Room</button>
                    </div>
                </div>

                <div class="players-section" id="playersSection"></div>

                <div class="game-table" id="gameTable">
                    <div class="trump-card-display" id="trumpDisplay">
                        <div class="deck-stack" id="deckStack">
                            <div class="deck-card"></div>
                            <div class="deck-card"></div>
                            <div class="deck-card"></div>
                            <div class="deck-count" id="deckCountDisplay">24</div>
                        </div>

                        <div class="trump-label" data-i18n="trump">Trump:</div>
                        <div id="trumpCardContainer"></div>
                    </div>
                    <div class="table-cards" id="tableCards">
                        <div class="empty-hand" data-i18n="table_empty">Table is empty</div>
                    </div>
                </div>

                <!-- <div class="quick-messages-section">
                    <div style="text-align: center; margin-bottom: 15px; font-weight: 600;">Tez Mesajlar:</div>
                    <div class="quick-messages-grid">
                        <button class="quick-msg-btn" onclick="sendQuickMsg('üëç', 'Yax≈üƒ±!')">üëç Yax≈üƒ±</button>
                        <button class="quick-msg-btn" onclick="sendQuickMsg('üòÇ', 'G√ºlm…ôli!')">üòÇ G√ºlm…ôli</button>
                        <button class="quick-msg-btn" onclick="sendQuickMsg('üî•', 'Super!')">üî• Super</button>
                        <button class="quick-msg-btn" onclick="sendQuickMsg('üòé', 'Cool!')">üòé Cool</button>
                        <button class="quick-msg-btn" onclick="sendQuickMsg('üí™', 'G√ºcl√º!')">üí™ G√ºcl√º</button>
                        <button class="quick-msg-btn" onclick="sendQuickMsg('üò¢', 'Pis!')">üò¢ Pis</button>
                        <button class="quick-msg-btn" onclick="sendQuickMsg('üéØ', 'D…ôqiq!')">üéØ D…ôqiq</button>
                        <button class="quick-msg-btn" onclick="sendQuickMsg('‚ö°', 'S√ºr…ôtli!')">‚ö° S√ºr…ôtli</button>
                    </div>
                </div> -->

                <div class="player-hand">
                    <div class="player-hand-title" data-i18n="your_cards">Your Cards</div>
                    <div class="cards-container" id="playerCards">
                        <div class="empty-hand" data-i18n="cards_loading">Loading your cards...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

        let currentUserToken = null;
        let currentUserData = null;
        let currentLanguage = 'en';

        const translations = {
            en: {
                page_title: 'Durak - Card Game',
                header_title: 'DURAK',
                loader_title: 'DURAK',
                loader_subtitle: 'Shuffling decks ‚Ä¢ Seating players',
                loader_status: 'Game is loading...',
                player_label: 'Player',
                room_options_title: 'Room Settings',
                bet_label: 'Bet Selection',
                modes_label: 'Game Modes',
                mode_atilan: 'Discarded',
                mode_pas: 'Pass',
                mode_qonsular: 'Neighbors',
                mode_hamisi: 'All',
                start: 'Start',
                back: '‚Üê Back',
                ready_rooms: 'üéÆ Ready Rooms',
                join_room_hint: 'Join one of the rooms below',
                rooms_loading: 'Loading rooms...',
                prize_pool: 'Prize Pool',
                room: 'Room',
                in_deck: 'In Deck',
                beaten: '‚úÖ Beaten',
                take_cards: 'üì• Take Cards',
                leave_room: 'Leave Room',
                trump: 'Trump:',
                table_empty: 'Table is empty',
                your_cards: 'Your Cards',
                cards_loading: 'Loading your cards...',
                cards_none: 'You have no cards',
                rooms_none: 'No suitable rooms available',
                loading_error: 'Loading error',
                deck_size_cards: '{{count}} cards',
                transfer_on: 'Transfer ‚úì',
                transfer_off: 'Transfer ‚úó',
                room_waiting: '‚è≥ Waiting',
                room_joined: 'You joined room {{room}}',
                entry_fee: 'Entry fee: {{fee}} AZN',
                player_joined: '{{name}} joined the game',
                player_left: '{{name}} left the game',
                game_started: 'Game started! üéÆ',
                cards_attacked: '{{name}} attacked',
                cards_defended: '{{name}} defended',
                cards_taken: '{{name}} took the cards',
                cards_discarded: 'Cards burned üî•',
                rematch_vote: '{{name}} wants a rematch ({{votes}}/{{required}})',
                rematch_question: 'Do you want to play again?',
                rematch_title: 'üîÑ Play Again',
                agree: '‚úÖ Agree',
                vote_recorded: 'Your vote is recorded! ‚è≥',
                error_prefix: 'Error: {{err}}',
                winner_prize: 'Prize: {{amount}} AZN',
                commission: 'Commission: {{amount}} AZN',
                server_connect_fail: 'Could not connect to server',
                server_connect_fail_retry: 'Could not connect to server. Please try again.',
                select_player_count: 'Select player count',
                room_searching: 'Searching for room...',
                room_create_success: 'New room created, joining...',
                room_create_unsupported: 'Room not created: server does not support',
                room_search_error: 'Error while searching for room',
                join_room_failed: 'Failed to join room',
                leave_room_failed: 'Failed to leave room',
                defend_missing_attack: 'Error: Attack card not found',
                defense_sent: 'Defense sent! ‚úÖ',
                defense_failed: 'Defense failed ‚ùå',
                defender_cant_attack: 'Defender cannot attack',
                only_attacker_first: 'Only the attacker can make the first attack',
                attack_sent: 'Attack sent! ‚öîÔ∏è',
                attack_added: 'Additional attack! ‚ûï',
                attack_failed: 'Attack failed: {{err}}',
                transfer_not_possible: 'Transfer not possible',
                transfer_sent: 'Transfer sent! üîÑ',
                transfer_failed: 'Transfer failed: {{err}}',
                beaten_failed: 'Beaten failed',
                take_cards_vote_failed: 'Failed to vote',
                leave_room_confirm: 'Are you sure you want to leave the room?',
                take_cards_defender: 'üì• I want to take cards',
                take_cards_attacker: 'üì• I agree to take',
                vote_action_beaten: 'üî• Beaten',
                vote_action_take: 'üì• Take',
                attack_transferred: 'üîÑ {{from}} transferred ‚Üí {{to}}',
                card_count: 'üÉè {{count}} cards',
                role_attacker: '‚öîÔ∏è Attacker',
                role_defender: 'üõ°Ô∏è Defender',
                rematch_fee: 'Entry fee: {{fee}} AZN',
                quick_room_title: '‚ö° {{room}}',
                prize_display: 'üèÜ {{amount}} AZN',
                take_cards_defender_btn: 'üì• I want to take cards',
                take_cards_attacker_btn: 'üì• I agree to take',
                beaten_btn: '‚úÖ Beaten'
            },
            tr: {
                page_title: 'Durak',
                header_title: 'DURAK',
                loader_title: 'DURAK',
                loader_subtitle: 'Deste karƒ±≈ütƒ±rƒ±lƒ±yor ‚Ä¢ Oyuncular yerle≈ütiriliyor',
                loader_status: 'Oyun y√ºkleniyor...',
                player_label: 'Oyuncu',
                room_options_title: 'Oda Ayarlarƒ±',
                bet_label: 'Bahis Se√ßimi',
                modes_label: 'Oyun Modlarƒ±',
                mode_atilan: 'Atƒ±lan',
                mode_pas: 'Pas',
                mode_qonsular: 'Kom≈üular',
                mode_hamisi: 'Hepsi',
                start: 'Ba≈üla',
                back: '‚Üê Geri',
                ready_rooms: 'üéÆ Hazƒ±r Odalar',
                join_room_hint: 'A≈üaƒüƒ±daki odalardan birine katƒ±lƒ±n',
                rooms_loading: 'Odalar y√ºkleniyor...',
                prize_pool: '√ñd√ºl Havuzu',
                room: 'Oda',
                in_deck: 'Destede',
                beaten: '‚úÖ Beaten',
                take_cards: 'üì• Kartlarƒ± Al',
                leave_room: 'Odadan √áƒ±k',
                trump: 'Koz:',
                table_empty: 'Masa bo≈ü',
                your_cards: 'Kartlarƒ±nƒ±z',
                cards_loading: 'Kartlarƒ±nƒ±z y√ºkleniyor...',
                cards_none: 'Kartƒ±nƒ±z yok',
                rooms_none: 'Uygun oda yok',
                loading_error: 'Y√ºkleme hatasƒ±',
                deck_size_cards: '{{count}} kart',
                transfer_on: 'Transfer ‚úì',
                transfer_off: 'Transfer ‚úó',
                room_waiting: '‚è≥ Bekliyor',
                room_joined: '{{room}} odasƒ±na katƒ±ldƒ±nƒ±z',
                entry_fee: 'Giri≈ü √ºcreti: {{fee}} AZN',
                player_joined: '{{name}} oyuna katƒ±ldƒ±',
                player_left: '{{name}} oyundan ayrƒ±ldƒ±',
                game_started: 'Oyun ba≈üladƒ±! üéÆ',
                cards_attacked: '{{name}} saldƒ±rdƒ±',
                cards_defended: '{{name}} savundu',
                cards_taken: '{{name}} kartlarƒ± aldƒ±',
                cards_discarded: 'Kartlar yakƒ±ldƒ± üî•',
                rematch_vote: '{{name}} r√∂van≈ü istiyor ({{votes}}/{{required}})',
                rematch_question: 'Tekrar oynamak istiyor musunuz?',
                rematch_title: 'üîÑ Tekrar Oyna',
                agree: '‚úÖ Kabul',
                vote_recorded: 'Oyunuz kaydedildi! ‚è≥',
                error_prefix: 'Hata: {{err}}',
                winner_prize: '√ñd√ºl: {{amount}} AZN',
                commission: 'Komisyon: {{amount}} AZN',
                server_connect_fail: 'Sunucuya baƒülanƒ±lamadƒ±',
                server_connect_fail_retry: 'Sunucuya baƒülanƒ±lamadƒ±. L√ºtfen tekrar deneyin.',
                select_player_count: 'Oyuncu sayƒ±sƒ±nƒ± se√ßin',
                room_searching: 'Oda aranƒ±yor...',
                room_create_success: 'Yeni oda olu≈üturuldu, katƒ±lƒ±yor...',
                room_create_unsupported: 'Oda olu≈üturulmadƒ±: sunucu desteklemiyor',
                room_search_error: 'Oda aranƒ±rken hata olu≈ütu',
                join_room_failed: 'Odaya katƒ±lma ba≈üarƒ±sƒ±z',
                leave_room_failed: 'Odadan √ßƒ±kma ba≈üarƒ±sƒ±z',
                defend_missing_attack: 'Hata: Saldƒ±rƒ± kartƒ± bulunamadƒ±',
                defense_sent: 'Savunma g√∂nderildi! ‚úÖ',
                defense_failed: 'Savunma ba≈üarƒ±sƒ±z ‚ùå',
                defender_cant_attack: 'Savunmacƒ± saldƒ±rƒ± yapamaz',
                only_attacker_first: 'ƒ∞lk saldƒ±rƒ±yƒ± yalnƒ±zca saldƒ±ran yapabilir',
                attack_sent: 'Saldƒ±rƒ± g√∂nderildi! ‚öîÔ∏è',
                attack_added: 'Ek saldƒ±rƒ±! ‚ûï',
                attack_failed: 'Saldƒ±rƒ± ba≈üarƒ±sƒ±z: {{err}}',
                transfer_not_possible: 'Transfer m√ºmk√ºn deƒüil',
                transfer_sent: 'Transfer g√∂nderildi! üîÑ',
                transfer_failed: 'Transfer ba≈üarƒ±sƒ±z: {{err}}',
                beaten_failed: 'Beaten ba≈üarƒ±sƒ±z',
                take_cards_vote_failed: 'Oylama ba≈üarƒ±sƒ±z',
                leave_room_confirm: 'Odadan √ßƒ±kmak istediƒüinize emin misiniz?',
                take_cards_defender: 'üì• Kartlarƒ± almak istiyorum',
                take_cards_attacker: 'üì• Almasƒ±na razƒ±yƒ±m',
                vote_action_beaten: 'üî• Beaten',
                vote_action_take: 'üì• Al',
                attack_transferred: 'üîÑ {{from}} transfer etti ‚Üí {{to}}',
                card_count: 'üÉè {{count}} kart',
                role_attacker: '‚öîÔ∏è Saldƒ±ran',
                role_defender: 'üõ°Ô∏è Savunan',
                rematch_fee: 'Giri≈ü √ºcreti: {{fee}} AZN',
                quick_room_title: '‚ö° {{room}}',
                prize_display: 'üèÜ {{amount}} AZN',
                take_cards_defender_btn: 'üì• Kartlarƒ± almak istiyorum',
                take_cards_attacker_btn: 'üì• Almasƒ±na razƒ±yƒ±m',
                beaten_btn: '‚úÖ Beaten'
            },
            hi: {
                page_title: 'Durak - ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ó‡•á‡§Æ',
                header_title: 'DURAK',
                loader_title: '‡§¶‡•Å‡§∞‡§æ‡§ï',
                loader_subtitle: '‡§°‡•á‡§ï ‡§∂‡§´‡§º‡§≤ ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç ‚Ä¢ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ä‡§ü ‡§§‡§Ø ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à',
                loader_status: '‡§ó‡•á‡§Æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',
                player_label: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',
                room_options_title: '‡§∞‡•Ç‡§Æ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏',
                bet_label: '‡§∂‡§∞‡•ç‡§§ ‡§ö‡§Ø‡§®',
                modes_label: '‡§ó‡•á‡§Æ ‡§Æ‡•ã‡§°‡•ç‡§∏',
                mode_atilan: '‡§´‡•á‡§Ç‡§ï‡§æ ‡§ó‡§Ø‡§æ',
                mode_pas: '‡§™‡§æ‡§∏',
                mode_qonsular: '‡§™‡§°‡§º‡•ã‡§∏‡•Ä',
                mode_hamisi: '‡§∏‡§≠‡•Ä',
                start: '‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',
                back: '‚Üê ‡§µ‡§æ‡§™‡§∏',
                ready_rooms: 'üéÆ ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§Æ‡§∞‡•á',
                join_room_hint: '‡§®‡•Ä‡§ö‡•á ‡§¶‡§ø‡§è ‡§ï‡§Æ‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§è‡§ï ‡§Æ‡•á‡§Ç ‡§ú‡•Å‡§°‡§º‡•á‡§Ç',
                rooms_loading: '‡§ï‡§Æ‡§∞‡•á ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',
                prize_pool: '‡§á‡§®‡§æ‡§Æ ‡§™‡•Ç‡§≤',
                room: '‡§∞‡•Ç‡§Æ',
                in_deck: '‡§°‡•á‡§ï ‡§Æ‡•á‡§Ç',
                beaten: '‚úÖ Beaten',
                take_cards: 'üì• ‡§ï‡§æ‡§∞‡•ç‡§° ‡§≤‡•á‡§Ç',
                leave_room: '‡§∞‡•Ç‡§Æ ‡§õ‡•ã‡§°‡§º‡•á‡§Ç',
                trump: '‡§ü‡•ç‡§∞‡§Æ‡•ç‡§™:',
                table_empty: '‡§ü‡•á‡§¨‡§≤ ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à',
                your_cards: '‡§Ü‡§™‡§ï‡•á ‡§ï‡§æ‡§∞‡•ç‡§°',
                cards_loading: '‡§Ü‡§™‡§ï‡•á ‡§ï‡§æ‡§∞‡•ç‡§° ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',
                cards_none: '‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç',
                rooms_none: '‡§ï‡•ã‡§à ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§∞‡•Ç‡§Æ ‡§®‡§π‡•Ä‡§Ç',
                loading_error: '‡§≤‡•ã‡§°‡§ø‡§Ç‡§ó ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø',
                deck_size_cards: '{{count}} ‡§ï‡§æ‡§∞‡•ç‡§°',
                transfer_on: 'Transfer ‚úì',
                transfer_off: 'Transfer ‚úó',
                room_waiting: '‚è≥ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•á‡§Ç',
                room_joined: '‡§Ü‡§™ {{room}} ‡§∞‡•Ç‡§Æ ‡§Æ‡•á‡§Ç ‡§ú‡•Å‡§°‡§º‡•á',
                entry_fee: '‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§∂‡•Å‡§≤‡•ç‡§ï: {{fee}} AZN',
                player_joined: '{{name}} ‡§ó‡•á‡§Æ ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•Å‡§Ü',
                player_left: '{{name}} ‡§ó‡•á‡§Æ ‡§õ‡•ã‡§°‡§º ‡§ó‡§Ø‡§æ',
                game_started: '‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•Å‡§Ü! üéÆ',
                cards_attacked: '{{name}} ‡§®‡•á ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§ø‡§Ø‡§æ',
                cards_defended: '{{name}} ‡§®‡•á ‡§¨‡§ö‡§æ‡§µ ‡§ï‡§ø‡§Ø‡§æ',
                cards_taken: '{{name}} ‡§®‡•á ‡§ï‡§æ‡§∞‡•ç‡§° ‡§≤‡•á ‡§≤‡§ø‡§è',
                cards_discarded: '‡§ï‡§æ‡§∞‡•ç‡§° ‡§ú‡§≤‡§æ ‡§¶‡§ø‡§è ‡§ó‡§è üî•',
                rematch_vote: '{{name}} ‡§∞‡•Ä‡§Æ‡•à‡§ö ‡§ö‡§æ‡§π‡§§‡§æ ‡§π‡•à ({{votes}}/{{required}})',
                rematch_question: '‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•á‡§≤‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?',
                rematch_title: 'üîÑ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•á‡§≤‡•á‡§Ç',
                agree: '‚úÖ ‡§∏‡§π‡§Æ‡§§',
                vote_recorded: '‡§Ü‡§™‡§ï‡§æ ‡§µ‡•ã‡§ü ‡§¶‡§∞‡•ç‡§ú ‡§π‡•ã ‡§ó‡§Ø‡§æ! ‚è≥',
                error_prefix: '‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: {{err}}',
                winner_prize: '‡§á‡§®‡§æ‡§Æ: {{amount}} AZN',
                commission: '‡§ï‡§Æ‡•Ä‡§∂‡§®: {{amount}} AZN',
                server_connect_fail: '‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ',
                server_connect_fail_retry: '‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ‡•§ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',
                select_player_count: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç',
                room_searching: '‡§∞‡•Ç‡§Æ ‡§ñ‡•ã‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...',
                room_create_success: '‡§®‡§Ø‡§æ ‡§∞‡•Ç‡§Æ ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ, ‡§ú‡•Å‡§°‡§º ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',
                room_create_unsupported: '‡§∞‡•Ç‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§æ: ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ',
                room_search_error: '‡§∞‡•Ç‡§Æ ‡§ñ‡•ã‡§ú‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à',
                join_room_failed: '‡§∞‡•Ç‡§Æ ‡§Æ‡•á‡§Ç ‡§ú‡•Å‡§°‡§º‡§®‡§æ ‡§Ö‡§∏‡§´‡§≤',
                leave_room_failed: '‡§∞‡•Ç‡§Æ ‡§õ‡•ã‡§°‡§º‡§®‡§æ ‡§Ö‡§∏‡§´‡§≤',
                defend_missing_attack: '‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ',
                defense_sent: '‡§¨‡§ö‡§æ‡§µ ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ! ‚úÖ',
                defense_failed: '‡§¨‡§ö‡§æ‡§µ ‡§Ö‡§∏‡§´‡§≤ ‚ùå',
                defender_cant_attack: '‡§∞‡§ï‡•ç‡§∑‡§ï ‡§π‡§Æ‡§≤‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ',
                only_attacker_first: '‡§™‡§π‡§≤‡§æ ‡§π‡§Æ‡§≤‡§æ ‡§ï‡•á‡§µ‡§≤ ‡§Ü‡§ï‡•ç‡§∞‡§Æ‡§£‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à',
                attack_sent: '‡§π‡§Æ‡§≤‡§æ ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ! ‚öîÔ∏è',
                attack_added: '‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§π‡§Æ‡§≤‡§æ! ‚ûï',
                attack_failed: '‡§π‡§Æ‡§≤‡§æ ‡§Ö‡§∏‡§´‡§≤: {{err}}',
                transfer_not_possible: '‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§∏‡§Ç‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç',
                transfer_sent: '‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ! üîÑ',
                transfer_failed: '‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§Ö‡§∏‡§´‡§≤: {{err}}',
                beaten_failed: 'Beaten ‡§Ö‡§∏‡§´‡§≤',
                take_cards_vote_failed: '‡§µ‡•ã‡§ü ‡§Ö‡§∏‡§´‡§≤',
                leave_room_confirm: '‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§∞‡•Ç‡§Æ ‡§õ‡•ã‡§°‡§º‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?',
                take_cards_defender: 'üì• ‡§Æ‡•à‡§Ç ‡§ï‡§æ‡§∞‡•ç‡§° ‡§≤‡•á‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡§æ ‡§π‡•Ç‡§Å',
                take_cards_attacker: 'üì• ‡§Æ‡•à‡§Ç ‡§≤‡•á‡§®‡•á ‡§∏‡•á ‡§∏‡§π‡§Æ‡§§ ‡§π‡•Ç‡§Å',
                vote_action_beaten: 'üî• Beaten',
                vote_action_take: 'üì• ‡§≤‡•á‡§®‡§æ',
                attack_transferred: 'üîÑ {{from}} ‡§®‡•á ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‚Üí {{to}}',
                card_count: 'üÉè {{count}} ‡§ï‡§æ‡§∞‡•ç‡§°',
                role_attacker: '‚öîÔ∏è ‡§Ü‡§ï‡•ç‡§∞‡§Æ‡§£‡§ï‡§∞‡•ç‡§§‡§æ',
                role_defender: 'üõ°Ô∏è ‡§∞‡§ï‡•ç‡§∑‡§ï',
                rematch_fee: '‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§∂‡•Å‡§≤‡•ç‡§ï: {{fee}} AZN',
                quick_room_title: '‚ö° {{room}}',
                prize_display: 'üèÜ {{amount}} AZN',
                take_cards_defender_btn: 'üì• ‡§Æ‡•à‡§Ç ‡§ï‡§æ‡§∞‡•ç‡§° ‡§≤‡•á‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡§æ ‡§π‡•Ç‡§Å',
                take_cards_attacker_btn: 'üì• ‡§Æ‡•à‡§Ç ‡§≤‡•á‡§®‡•á ‡§∏‡•á ‡§∏‡§π‡§Æ‡§§ ‡§π‡•Ç‡§Å',
                beaten_btn: '‚úÖ Beaten'
            },
            ru: {
                page_title: 'Durak - –ö–∞—Ä—Ç–æ—á–Ω–∞—è –∏–≥—Ä–∞',
                header_title: 'DURAK',
                loader_title: '–î–£–†–ê–ö',
                loader_subtitle: '–¢–∞—Å—É–µ–º –∫–æ–ª–æ–¥—ã ‚Ä¢ –†–∞—Å—Å–∞–∂–∏–≤–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤',
                loader_status: '–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...',
                player_label: '–ò–≥—Ä–æ–∫',
                room_options_title: '–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–Ω–∞—Ç—ã',
                bet_label: '–í—ã–±–æ—Ä —Å—Ç–∞–≤–∫–∏',
                modes_label: '–†–µ–∂–∏–º—ã –∏–≥—Ä—ã',
                mode_atilan: '–°–±—Ä–æ—à–µ–Ω–æ',
                mode_pas: '–ü–∞—Å',
                mode_qonsular: '–°–æ—Å–µ–¥–∏',
                mode_hamisi: '–í—Å–µ',
                start: '–ù–∞—á–∞—Ç—å',
                back: '‚Üê –ù–∞–∑–∞–¥',
                ready_rooms: 'üéÆ –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–Ω–∞—Ç—ã',
                join_room_hint: '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ –æ–¥–Ω–æ–π –∏–∑ –∫–æ–º–Ω–∞—Ç –Ω–∏–∂–µ',
                rooms_loading: '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–Ω–∞—Ç...',
                prize_pool: '–ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥',
                room: '–ö–æ–º–Ω–∞—Ç–∞',
                in_deck: '–í –∫–æ–ª–æ–¥–µ',
                beaten: '‚úÖ Beaten',
                take_cards: 'üì• –í–∑—è—Ç—å –∫–∞—Ä—Ç—ã',
                leave_room: '–í—ã–π—Ç–∏ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã',
                trump: '–ö–æ–∑—ã—Ä—å:',
                table_empty: '–°—Ç–æ–ª –ø—É—Å—Ç',
                your_cards: '–í–∞—à–∏ –∫–∞—Ä—Ç—ã',
                cards_loading: '–í–∞—à–∏ –∫–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...',
                cards_none: '–£ –≤–∞—Å –Ω–µ—Ç –∫–∞—Ä—Ç',
                rooms_none: '–ü–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–æ–º–Ω–∞—Ç –Ω–µ—Ç',
                loading_error: '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏',
                deck_size_cards: '{{count}} –∫–∞—Ä—Ç',
                transfer_on: 'Transfer ‚úì',
                transfer_off: 'Transfer ‚úó',
                room_waiting: '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ',
                room_joined: '–í—ã –≤–æ—à–ª–∏ –≤ –∫–æ–º–Ω–∞—Ç—É {{room}}',
                entry_fee: '–í–∑–Ω–æ—Å: {{fee}} AZN',
                player_joined: '{{name}} –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∏–≥—Ä–µ',
                player_left: '{{name}} –≤—ã—à–µ–ª –∏–∑ –∏–≥—Ä—ã',
                game_started: '–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! üéÆ',
                cards_attacked: '{{name}} –∞—Ç–∞–∫–æ–≤–∞–ª',
                cards_defended: '{{name}} –∑–∞—â–∏—Ç–∏–ª—Å—è',
                cards_taken: '{{name}} –≤–∑—è–ª –∫–∞—Ä—Ç—ã',
                cards_discarded: '–ö–∞—Ä—Ç—ã —Å–æ–∂–∂–µ–Ω—ã üî•',
                rematch_vote: '{{name}} —Ö–æ—á–µ—Ç —Ä–µ–≤–∞–Ω—à ({{votes}}/{{required}})',
                rematch_question: '–•–æ—Ç–∏—Ç–µ —Å—ã–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞?',
                rematch_title: 'üîÑ –°—ã–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞',
                agree: '‚úÖ –°–æ–≥–ª–∞—Å–µ–Ω',
                vote_recorded: '–í–∞—à –≥–æ–ª–æ—Å —É—á—Ç—ë–Ω! ‚è≥',
                error_prefix: '–û—à–∏–±–∫–∞: {{err}}',
                winner_prize: '–ü—Ä–∏–∑: {{amount}} AZN',
                commission: '–ö–æ–º–∏—Å—Å–∏—è: {{amount}} AZN',
                server_connect_fail: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É',
                server_connect_fail_retry: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É.',
                select_player_count: '–í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ –∏–≥—Ä–æ–∫–æ–≤',
                room_searching: '–ü–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç—ã...',
                room_create_success: '–ù–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞, –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è...',
                room_create_unsupported: '–ö–æ–º–Ω–∞—Ç–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞: —Å–µ—Ä–≤–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç',
                room_search_error: '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –∫–æ–º–Ω–∞—Ç—ã',
                join_room_failed: '–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É',
                leave_room_failed: '–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–π—Ç–∏ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã',
                defend_missing_attack: '–û—à–∏–±–∫–∞: –∫–∞—Ä—Ç–∞ –∞—Ç–∞–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞',
                defense_sent: '–ó–∞—â–∏—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! ‚úÖ',
                defense_failed: '–ó–∞—â–∏—Ç–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å ‚ùå',
                defender_cant_attack: '–ó–∞—â–∏—Ç–Ω–∏–∫ –Ω–µ –º–æ–∂–µ—Ç –∞—Ç–∞–∫–æ–≤–∞—Ç—å',
                only_attacker_first: '–ü–µ—Ä–≤—É—é –∞—Ç–∞–∫—É –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞—Ç–∞–∫—É—é—â–∏–π',
                attack_sent: '–ê—Ç–∞–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! ‚öîÔ∏è',
                attack_added: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞—Ç–∞–∫–∞! ‚ûï',
                attack_failed: '–ê—Ç–∞–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å: {{err}}',
                transfer_not_possible: '–¢—Ä–∞–Ω—Å—Ñ–µ—Ä –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω',
                transfer_sent: '–¢—Ä–∞–Ω—Å—Ñ–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! üîÑ',
                transfer_failed: '–¢—Ä–∞–Ω—Å—Ñ–µ—Ä –Ω–µ —É–¥–∞–ª—Å—è: {{err}}',
                beaten_failed: 'Beaten –Ω–µ —É–¥–∞–ª—Å—è',
                take_cards_vote_failed: '–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å',
                leave_room_confirm: '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã?',
                take_cards_defender: 'üì• –•–æ—á—É –≤–∑—è—Ç—å –∫–∞—Ä—Ç—ã',
                take_cards_attacker: 'üì• –°–æ–≥–ª–∞—Å–µ–Ω –≤–∑—è—Ç—å',
                vote_action_beaten: 'üî• Beaten',
                vote_action_take: 'üì• –í–∑—è—Ç—å',
                attack_transferred: 'üîÑ {{from}} –ø–µ—Ä–µ–¥–∞–ª ‚Üí {{to}}',
                card_count: 'üÉè {{count}} –∫–∞—Ä—Ç',
                role_attacker: '‚öîÔ∏è –ê—Ç–∞–∫—É—é—â–∏–π',
                role_defender: 'üõ°Ô∏è –ó–∞—â–∏—Ç–Ω–∏–∫',
                rematch_fee: '–í–∑–Ω–æ—Å: {{fee}} AZN',
                quick_room_title: '‚ö° {{room}}',
                prize_display: 'üèÜ {{amount}} AZN',
                take_cards_defender_btn: 'üì• –•–æ—á—É –≤–∑—è—Ç—å –∫–∞—Ä—Ç—ã',
                take_cards_attacker_btn: 'üì• –°–æ–≥–ª–∞—Å–µ–Ω –≤–∑—è—Ç—å',
                beaten_btn: '‚úÖ Beaten'
            },
            ar: {
                page_title: 'Durak - ŸÑÿπÿ®ÿ© Ÿàÿ±ŸÇ',
                header_title: 'DURAK',
                loader_title: 'ÿØŸàÿ±ÿßŸÉ',
                loader_subtitle: 'Ÿäÿ™ŸÖ ÿÆŸÑÿ∑ ÿßŸÑÿ£Ÿàÿ±ÿßŸÇ ‚Ä¢ Ÿäÿ™ŸÖ ÿ¨ŸÑŸàÿ≥ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ',
                loader_status: 'ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÑÿπÿ®ÿ©...',
                player_label: 'ŸÑÿßÿπÿ®',
                room_options_title: 'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∫ÿ±ŸÅÿ©',
                bet_label: 'ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ±ŸáÿßŸÜ',
                modes_label: 'ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑŸÑÿπÿ®ÿ©',
                mode_atilan: 'ŸÖÿ∑ÿ±Ÿàÿ≠',
                mode_pas: 'ÿ™ŸÖÿ±Ÿäÿ±',
                mode_qonsular: 'ÿßŸÑÿ¨Ÿäÿ±ÿßŸÜ',
                mode_hamisi: 'ÿßŸÑŸÉŸÑ',
                start: 'ÿßÿ®ÿØÿ£',
                back: '‚Üê ÿ±ÿ¨Ÿàÿπ',
                ready_rooms: 'üéÆ ÿ∫ÿ±ŸÅ ÿ¨ÿßŸáÿ≤ÿ©',
                join_room_hint: 'ÿßŸÜÿ∂ŸÖ ÿ•ŸÑŸâ ÿ•ÿ≠ÿØŸâ ÿßŸÑÿ∫ÿ±ŸÅ ÿ£ÿØŸÜÿßŸá',
                rooms_loading: 'ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ∫ÿ±ŸÅ...',
                prize_pool: 'ÿµŸÜÿØŸàŸÇ ÿßŸÑÿ¨Ÿàÿßÿ¶ÿ≤',
                room: 'ÿßŸÑÿ∫ÿ±ŸÅÿ©',
                in_deck: 'ŸÅŸä ÿßŸÑÿ±ÿ≤ŸÖÿ©',
                beaten: '‚úÖ Beaten',
                take_cards: 'üì• ÿ£ÿÆÿ∞ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™',
                leave_room: 'ŸÖÿ∫ÿßÿØÿ±ÿ© ÿßŸÑÿ∫ÿ±ŸÅÿ©',
                trump: 'ÿßŸÑÿ™ÿ±ÿßŸÖÿ®:',
                table_empty: 'ÿßŸÑÿ∑ÿßŸàŸÑÿ© ŸÅÿßÿ±ÿ∫ÿ©',
                your_cards: 'ÿ®ÿ∑ÿßŸÇÿßÿ™ŸÉ',
                cards_loading: 'ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ÿ∑ÿßŸÇÿßÿ™ŸÉ...',
                cards_none: 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ÿ∑ÿßŸÇÿßÿ™ ŸÑÿØŸäŸÉ',
                rooms_none: 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ∫ÿ±ŸÅ ŸÖŸÜÿßÿ≥ÿ®ÿ©',
                loading_error: 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ',
                deck_size_cards: '{{count}} ÿ®ÿ∑ÿßŸÇÿ©',
                transfer_on: 'Transfer ‚úì',
                transfer_off: 'Transfer ‚úó',
                room_waiting: '‚è≥ ÿßŸÜÿ™ÿ∏ÿßÿ±',
                room_joined: 'ÿßŸÜÿ∂ŸÖŸÖÿ™ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ© {{room}}',
                entry_fee: 'ÿ±ÿ≥ŸàŸÖ ÿßŸÑÿØÿÆŸàŸÑ: {{fee}} AZN',
                player_joined: '{{name}} ÿßŸÜÿ∂ŸÖ ÿ•ŸÑŸâ ÿßŸÑŸÑÿπÿ®ÿ©',
                player_left: '{{name}} ÿ∫ÿßÿØÿ± ÿßŸÑŸÑÿπÿ®ÿ©',
                game_started: 'ÿ®ÿØÿ£ÿ™ ÿßŸÑŸÑÿπÿ®ÿ©! üéÆ',
                cards_attacked: '{{name}} Ÿáÿßÿ¨ŸÖ',
                cards_defended: '{{name}} ÿØÿßŸÅÿπ',
                cards_taken: '{{name}} ÿ£ÿÆÿ∞ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™',
                cards_discarded: 'ÿ™ŸÖ ÿ≠ÿ±ŸÇ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ üî•',
                rematch_vote: '{{name}} Ÿäÿ±ŸäÿØ ÿ•ÿπÿßÿØÿ© ŸÖÿ®ÿßÿ±ÿßÿ© ({{votes}}/{{required}})',
                rematch_question: 'ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿßŸÑŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâÿü',
                rematch_title: 'üîÑ ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ',
                agree: '‚úÖ ŸÖŸàÿßŸÅŸÇ',
                vote_recorded: 'ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿµŸàÿ™ŸÉ! ‚è≥',
                error_prefix: 'ÿÆÿ∑ÿ£: {{err}}',
                winner_prize: 'ÿßŸÑÿ¨ÿßÿ¶ÿ≤ÿ©: {{amount}} AZN',
                commission: 'ÿßŸÑÿπŸÖŸàŸÑÿ©: {{amount}} AZN',
                server_connect_fail: 'ÿ™ÿπÿ∞ÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿÆÿßÿØŸÖ',
                server_connect_fail_retry: 'ÿ™ÿπÿ∞ÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿÆÿßÿØŸÖ. ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.',
                select_player_count: 'ÿßÿÆÿ™ÿ± ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ',
                room_searching: 'ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿ∫ÿ±ŸÅÿ©...',
                room_create_success: 'ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿ∫ÿ±ŸÅÿ© ÿ¨ÿØŸäÿØÿ©ÿå ÿ¨ÿßÿ±Ÿç ÿßŸÑÿßŸÜÿ∂ŸÖÿßŸÖ...',
                room_create_unsupported: 'ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ∫ÿ±ŸÅÿ©: ÿßŸÑÿÆÿßÿØŸÖ ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖ',
                room_search_error: 'ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿ∫ÿ±ŸÅÿ©',
                join_room_failed: 'ÿ™ÿπÿ∞ÿ± ÿßŸÑÿßŸÜÿ∂ŸÖÿßŸÖ ÿ•ŸÑŸâ ÿßŸÑÿ∫ÿ±ŸÅÿ©',
                leave_room_failed: 'ÿ™ÿπÿ∞ÿ± ŸÖÿ∫ÿßÿØÿ±ÿ© ÿßŸÑÿ∫ÿ±ŸÅÿ©',
                defend_missing_attack: 'ÿÆÿ∑ÿ£: ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸáÿ¨ŸàŸÖ',
                defense_sent: 'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿØŸÅÿßÿπ! ‚úÖ',
                defense_failed: 'ŸÅÿ¥ŸÑ ÿßŸÑÿØŸÅÿßÿπ ‚ùå',
                defender_cant_attack: 'ÿßŸÑŸÖÿØÿßŸÅÿπ ŸÑÿß ŸäŸÖŸÉŸÜŸá ÿßŸÑŸáÿ¨ŸàŸÖ',
                only_attacker_first: 'ÿßŸÑŸáÿ¨ŸàŸÖ ÿßŸÑÿ£ŸàŸÑ ŸäŸÇŸàŸÖ ÿ®Ÿá ÿßŸÑŸÖŸáÿßÿ¨ŸÖ ŸÅŸÇÿ∑',
                attack_sent: 'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸáÿ¨ŸàŸÖ! ‚öîÔ∏è',
                attack_added: 'Ÿáÿ¨ŸàŸÖ ÿ•ÿ∂ÿßŸÅŸä! ‚ûï',
                attack_failed: 'ŸÅÿ¥ŸÑ ÿßŸÑŸáÿ¨ŸàŸÖ: {{err}}',
                transfer_not_possible: 'ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ ÿ∫Ÿäÿ± ŸÖŸÖŸÉŸÜ',
                transfer_sent: 'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ! üîÑ',
                transfer_failed: 'ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ: {{err}}',
                beaten_failed: 'ŸÅÿ¥ŸÑ Beaten',
                take_cards_vote_failed: 'ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿµŸàŸäÿ™',
                leave_room_confirm: 'ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ÿ£ŸÜŸÉ ÿ™ÿ±ŸäÿØ ŸÖÿ∫ÿßÿØÿ±ÿ© ÿßŸÑÿ∫ÿ±ŸÅÿ©ÿü',
                take_cards_defender: 'üì• ÿ£ÿ±ŸäÿØ ÿ£ÿÆÿ∞ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™',
                take_cards_attacker: 'üì• ÿ£ŸàÿßŸÅŸÇ ÿπŸÑŸâ ÿßŸÑÿ£ÿÆÿ∞',
                vote_action_beaten: 'üî• Beaten',
                vote_action_take: 'üì• ÿ£ÿÆÿ∞',
                attack_transferred: 'üîÑ {{from}} ŸÜŸÇŸÑ ‚Üí {{to}}',
                card_count: 'üÉè {{count}} ÿ®ÿ∑ÿßŸÇÿ©',
                role_attacker: '‚öîÔ∏è ŸÖŸáÿßÿ¨ŸÖ',
                role_defender: 'üõ°Ô∏è ŸÖÿØÿßŸÅÿπ',
                rematch_fee: 'ÿ±ÿ≥ŸàŸÖ ÿßŸÑÿØÿÆŸàŸÑ: {{fee}} AZN',
                quick_room_title: '‚ö° {{room}}',
                prize_display: 'üèÜ {{amount}} AZN',
                take_cards_defender_btn: 'üì• ÿ£ÿ±ŸäÿØ ÿ£ÿÆÿ∞ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™',
                take_cards_attacker_btn: 'üì• ÿ£ŸàÿßŸÅŸÇ ÿπŸÑŸâ ÿßŸÑÿ£ÿÆÿ∞',
                beaten_btn: '‚úÖ Beaten'
            },
            uz: {
                page_title: 'Durak - Karta o‚Äòyini',
                header_title: 'DURAK',
                loader_title: 'DURAK',
                loader_subtitle: 'Kolodalar aralashtirilmoqda ‚Ä¢ O‚Äòyinchilar joylashtirilmoqda',
                loader_status: 'O‚Äòyin yuklanmoqda...',
                player_label: 'O‚Äòyinchi',
                room_options_title: 'Xona sozlamalari',
                bet_label: 'Tikish tanlovi',
                modes_label: 'O‚Äòyin rejimlari',
                mode_atilan: 'Tashlangan',
                mode_pas: 'Pas',
                mode_qonsular: 'Qo‚Äòshnilar',
                mode_hamisi: 'Hammasi',
                start: 'Boshlash',
                back: '‚Üê Orqaga',
                ready_rooms: 'üéÆ Tayyor xonalar',
                join_room_hint: 'Quyidagi xonalardan biriga qo‚Äòshiling',
                rooms_loading: 'Xonalar yuklanmoqda...',
                prize_pool: 'Mukofot jamg‚Äòarmasi',
                room: 'Xona',
                in_deck: 'Dastada',
                beaten: '‚úÖ Beaten',
                take_cards: 'üì• Kartalarni olish',
                leave_room: 'Xonadan chiqish',
                trump: 'Kozir:',
                table_empty: 'Stol bo‚Äòsh',
                your_cards: 'Kartalaringiz',
                cards_loading: 'Kartalaringiz yuklanmoqda...',
                cards_none: 'Kartangiz yo‚Äòq',
                rooms_none: 'Mos xona yo‚Äòq',
                loading_error: 'Yuklash xatosi',
                deck_size_cards: '{{count}} karta',
                transfer_on: 'Transfer ‚úì',
                transfer_off: 'Transfer ‚úó',
                room_waiting: '‚è≥ Kutilmoqda',
                room_joined: '{{room}} xonasiga qo‚Äòshildingiz',
                entry_fee: 'Kirish to‚Äòlovi: {{fee}} AZN',
                player_joined: '{{name}} o‚Äòyinga qo‚Äòshildi',
                player_left: '{{name}} o‚Äòyindan chiqdi',
                game_started: 'O‚Äòyin boshlandi! üéÆ',
                cards_attacked: '{{name}} hujum qildi',
                cards_defended: '{{name}} himoya qildi',
                cards_taken: '{{name}} kartalarni oldi',
                cards_discarded: 'Kartalar yoqildi üî•',
                rematch_vote: '{{name}} qayta o‚Äòynashni xohlaydi ({{votes}}/{{required}})',
                rematch_question: 'Qayta o‚Äòynashni xohlaysizmi?',
                rematch_title: 'üîÑ Qayta o‚Äòynash',
                agree: '‚úÖ Roziman',
                vote_recorded: 'Ovozingiz qayd etildi! ‚è≥',
                error_prefix: 'Xato: {{err}}',
                winner_prize: 'Mukofot: {{amount}} AZN',
                commission: 'Komissiya: {{amount}} AZN',
                server_connect_fail: 'Serverga ulanib bo‚Äòlmadi',
                server_connect_fail_retry: 'Serverga ulanib bo‚Äòlmadi. Qayta urinib ko‚Äòring.',
                select_player_count: 'O‚Äòyinchilar sonini tanlang',
                room_searching: 'Xona qidirilmoqda...',
                room_create_success: 'Yangi xona yaratildi, qo‚Äòshilmoqda...',
                room_create_unsupported: 'Xona yaratilmagan: server qo‚Äòllab-quvvatlamaydi',
                room_search_error: 'Xona qidirishda xato yuz berdi',
                join_room_failed: 'Xonaga qo‚Äòshilish muvaffaqiyatsiz',
                leave_room_failed: 'Xonadan chiqish muvaffaqiyatsiz',
                defend_missing_attack: 'Xato: Hujum kartasi topilmadi',
                defense_sent: 'Himoya yuborildi! ‚úÖ',
                defense_failed: 'Himoya muvaffaqiyatsiz ‚ùå',
                defender_cant_attack: 'Himoyachi hujum qila olmaydi',
                only_attacker_first: 'Birinchi hujumni faqat hujumchi qiladi',
                attack_sent: 'Hujum yuborildi! ‚öîÔ∏è',
                attack_added: 'Qo‚Äòshimcha hujum! ‚ûï',
                attack_failed: 'Hujum muvaffaqiyatsiz: {{err}}',
                transfer_not_possible: 'Transfer mumkin emas',
                transfer_sent: 'Transfer yuborildi! üîÑ',
                transfer_failed: 'Transfer muvaffaqiyatsiz: {{err}}',
                beaten_failed: 'Beaten muvaffaqiyatsiz',
                take_cards_vote_failed: 'Ovoz berish muvaffaqiyatsiz',
                leave_room_confirm: 'Xonadan chiqishni xohlaysizmi?',
                take_cards_defender: 'üì• Kartalarni olishni xohlayman',
                take_cards_attacker: 'üì• Olishiga roziman',
                vote_action_beaten: 'üî• Beaten',
                vote_action_take: 'üì• Olish',
                attack_transferred: 'üîÑ {{from}} transfer qildi ‚Üí {{to}}',
                card_count: 'üÉè {{count}} karta',
                role_attacker: '‚öîÔ∏è Hujumchi',
                role_defender: 'üõ°Ô∏è Himoyachi',
                rematch_fee: 'Kirish to‚Äòlovi: {{fee}} AZN',
                quick_room_title: '‚ö° {{room}}',
                prize_display: 'üèÜ {{amount}} AZN',
                take_cards_defender_btn: 'üì• Kartalarni olishni xohlayman',
                take_cards_attacker_btn: 'üì• Olishiga roziman',
                beaten_btn: '‚úÖ Beaten'
            }
        };

        function normalizeLanguage(lang) {
            if (!lang) return 'en';
            const l = String(lang).toLowerCase().trim();
            if (['en', 'eng', 'english'].includes(l)) return 'en';
            if (['tr', 'tur', 'turkish', 't√ºrk√ße'].includes(l)) return 'tr';
            if (['hi', 'in', 'hindi', 'indian'].includes(l)) return 'hi';
            if (['ru', 'rus', 'russian'].includes(l)) return 'ru';
            if (['ar', 'ara', 'arabic', 'ÿπÿ±ÿ®Ÿä'].includes(l)) return 'ar';
            if (['uz', 'uzb', 'uzbek', 'o ªzbek', 'ozbek'].includes(l)) return 'uz';
            return translations[l] ? l : 'en';
        }

        function t(key, vars = {}) {
            const dict = translations[currentLanguage] || translations.en;
            const fallback = translations.en || {};
            let text = dict[key] || fallback[key] || key;
            Object.keys(vars).forEach(k => {
                text = text.replace(new RegExp(`{{\\s*${k}\\s*}}`, 'g'), vars[k]);
            });
            return text;
        }

        function applyTranslations() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.textContent = t(key);
            });
            document.title = t('page_title');
        }

        function setLanguage(lang) {
            currentLanguage = normalizeLanguage(lang);
            document.documentElement.lang = currentLanguage;
            document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
            applyTranslations();
            if (typeof updateActionButtons === 'function' && typeof gameState !== 'undefined') {
                updateActionButtons(gameState || {});
            }
        }

        console.log('üÉè [DURAK] Script y√ºkl…ôndi');

        window.addEventListener('message', (event) => {
            console.log('üì® [DURAK] Message alƒ±ndƒ±:', event.data);

            if (event.data && event.data.payload.language) {
                setLanguage(event.data.payload.language);
            }

            if (event.data && event.data.type === 'INIT_USER') {
                console.log('‚úÖ [DURAK] INIT_USER q…ôbul edildi');

                currentUserData = event.data.payload;
                currentUserToken = currentUserData.token;

                console.log('üë§ [DURAK] User:', currentUserData.username);
                console.log('üé´ [DURAK] Token:', currentUserToken ? 'VAR' : 'YOX');

                // UI-ƒ± yenil…ô
                document.getElementById('userBalance').textContent = currentUserData.balance;

                console.log('üöÄ [DURAK] init() √ßaƒüƒ±rƒ±lƒ±r...');
                // SignalR ba≈ülat
                init();
            }
        });

        // ============================================
        // getToken funksiyasƒ±nƒ± d…ôyi≈üdir
        // ============================================
        function getToken() {
            return currentUserToken || "";
        }

        // ============================================
        // Qalan kod eyni qalƒ±r
        // ============================================

        // M√∂vcud connection, currentUser v…ô s. d…ôyi≈ü…ônl…ôr...
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("https://nehemiah-paginal-alan.ngrok-free.dev/durakHub", { accessTokenFactory: () => getToken() })
            .withAutomaticReconnect()
            .build();


        let currentUser = null;
        let currentRoom = null;
        let myCards = [];
        let gameState = null;
        let selectedPlayerCount = 0;
        let selectedDeckSize = 36;
        let selectedBet = 0;
        // modes: enforce exactly one per column
        let selectedModes = { col1: 'atilan', col2: 'qonsular' };
        let draggedCard = null;

        const suitIcons = {
            'Hearts': '‚ô•',
            'Diamonds': '‚ô¶',
            'Clubs': '‚ô£',
            'Spades': '‚ô†'
        };

        const rankNames = {
            '2': '2', '3': '3', '4': '4', '5': '5',
            '6': '6', '7': '7', '8': '8', '9': '9', '10': '10',
            'Jack': 'J', 'Queen': 'Q', 'King': 'K', 'Ace': 'A'
        };

        // ‚úÖ init() funksiyasƒ±nƒ± sad…ôl…ô≈üdir
        async function init() {
            console.log('üöÄ [DURAK] init() ba≈üladƒ±');

            if (!currentUserToken) {
                console.error('‚ùå [DURAK] Token yoxdur!');
                return;
            }

            try {
                await connection.start();
                console.log("‚úÖ [DURAK] SignalR qo≈üuldu");
                hideLoader();
            } catch (err) {
                console.error("‚ùå [DURAK] SignalR x…ôtasƒ±:", err);
                // showMessage(t("server_connect_fail"), "error");
            }
        }


        // ... suitIcons, rankNames v…ô s. ...



        // ... qalan b√ºt√ºn kod eyni qalƒ±r (setupEventHandlers v…ô s.) ...
        // ‚úÖ YENƒ∞ - Transfer event
        connection.on("AttackTransferred", (data) => {
            showMessage(t("attack_transferred", { from: data.playerName, to: data.newDefender }), "info");
            console.log('üîÑ Transfer:', data);
        });
        // ‚úÖ YENƒ∞ - Player Vote notification
        connection.on("PlayerVoted", (data) => {
            showVoteNotification(data);
        });
        // ‚ùå Sƒ∞L - connection.on("UserData") event handler-ini d…ôyi≈üdir:
        connection.on("UserData", (data) => {
            currentUser = data;
            console.log('üë§ [DURAK] UserData event:', data);

            // ‚úÖ Artƒ±q React-d…ôn aldƒ±q, yenid…ôn yazmƒ±rƒ±q
            // document.getElementById("userName").textContent = data.fullName;

            document.getElementById("lobbyScreen").style.display = "block";

            // URL parametrind…ôn player count yoxla
            const urlParams = new URLSearchParams(window.location.search);
            const playersParam = urlParams.get('players');
            if (playersParam && ['2', '3', '4', '6'].includes(playersParam)) {
                selectPlayerCount(parseInt(playersParam));
            }
        });


        connection.on("RefundProcessed", (data) => {
            showMessage(data.message, "success");
            console.log('üí∏ Refund:', data.amount, 'AZN');
        });

        connection.on("JoinedRoom", (data) => {
            currentRoom = data;
            document.getElementById("currentRoomName").textContent = data.roomName;
            document.getElementById("lobbyScreen").style.display = "none";
            document.getElementById("gameScreen").style.display = "block";

            document.getElementsByClassName("header")[0].style.display = "none";

            let message = t("room_joined", { room: data.roomName });
            if (data.entryFee > 0) {
                message += ` (${t("entry_fee", { fee: data.entryFee })})`;
            }
            showMessage(message, "success");
        });

        connection.on("PlayerJoined", (playerName) => {
            showMessage(t("player_joined", { name: playerName }), "info");
        });

        connection.on("PlayerLeft", (playerName) => {
            showMessage(t("player_left", { name: playerName }), "info");
        });

        connection.on("GameStarted", (data) => {
            showMessage(t("game_started"), "success");
            renderTrumpCard(data.trumpCard);
        });

        connection.on("YourCards", (cards) => {
            myCards = cards;
            renderPlayerCards();
        });

        connection.on("GameState", (state) => {
            gameState = state;
            console.log('üéÆ GAME STATE UPDATED:', state);

            renderPlayers(state.players);
            renderTableCards(state);

            document.getElementById("deckCount").textContent = state.deckCount;
            document.getElementById("deckCountDisplay").textContent = state.deckCount;

            // ‚úÖ YENƒ∞ - Deck size v…ô transfer info
            if (state.deckSize) {
                document.getElementById("deckSizeInfo").textContent = t("deck_size_cards", { count: state.deckSize });
            }

            if (state.transferEnabled !== undefined) {
                const transferBadge = document.getElementById("transferInfo");
                if (state.transferEnabled) {
                    transferBadge.textContent = t("transfer_on");
                    transferBadge.classList.remove('disabled');
                } else {
                    transferBadge.textContent = t("transfer_off");
                    transferBadge.classList.add('disabled');
                }
            }

            const deckStack = document.getElementById("deckStack");
            if (state.deckCount === 0) {
                deckStack.style.display = 'none';
            } else {
                deckStack.style.display = 'block';
            }

            if (state.totalPrize > 0) {
                document.getElementById("totalPrize").textContent = `${state.totalPrize} AZN`;
            }

            if (myCards.length > 0) {
                renderPlayerCards();
            }

            updateActionButtons(state);
        });

        connection.on("CardsAttacked", (data) => {
            showMessage(t("cards_attacked", { name: data.playerName }), "info");
        });

        connection.on("CardsDefended", (data) => {
            showMessage(t("cards_defended", { name: data.playerName }), "success");
        });

        connection.on("CardsTaken", (data) => {
            showMessage(t("cards_taken", { name: data.playerName }), "warning");
        });

        connection.on("CardsDiscarded", () => {
            showMessage(t("cards_discarded"), "success");
        });

        connection.on("GameOver", (data) => {
            showMessage(data.message, "info");

            let alertMessage = data.message;
            if (data.winnerPrize) {
                alertMessage += `\n\nüí∞ ${t("winner_prize", { amount: data.winnerPrize })}`;
                alertMessage += `\nüìä ${t("commission", { amount: data.commission })}`;
            }

            if (data.canRematch) {
                alertMessage += `\n\nüîÑ ${t("rematch_question")}`;
                if (data.entryFee > 0) {
                    alertMessage += `\n(${t("entry_fee", { fee: data.entryFee })})`;
                }
            }

            alert(alertMessage);

            if (data.canRematch) {
                showRematchUI(data.entryFee);
            }
        });

        connection.on("RematchVote", (data) => {
            showMessage(t("rematch_vote", { name: data.playerName, votes: data.votes, required: data.required }), "info");
        });

        connection.on("RematchFailed", (data) => {
            showMessage(data.message, "error");
            hideRematchUI();
        });

        connection.on("Error", (msg) => showMessage(msg, "error"));
        connection.on("JoinError", (msg) => showMessage(msg, "error"));
        connection.on("GameError", (msg) => showMessage(msg, "error"));
        connection.on("ActionError", (msg) => showMessage(msg, "error"));

        connection.on("LeftRoom", () => {
            currentRoom = null;
            myCards = [];
            gameState = null;
            document.getElementById("gameScreen").style.display = "none";
            document.getElementById("lobbyScreen").style.display = "block";
            document.getElementById("roomsSection").style.display = "none";

            document.getElementsByClassName("header")[0].style.display = "block";

        });

        connection.on("QuickMessage", (data) => {
            showMessage(`${data.playerName}: ${data.emoji} ${data.message}`, "info");
            const display = document.createElement("div");
            display.className = "quick-message-display";
            display.innerHTML = `
                    <div style="margin-bottom: 10px; font-size: 0.5em; opacity: 0.8;">${data.playerName}</div>
                    <div>${data.emoji} ${data.message}</div>
                `;
            document.body.appendChild(display);
            setTimeout(() => display.remove(), 2000);
        });

        // ============ Helper Functions ============

        function showVoteNotification(data) {
            document.querySelectorAll('.vote-notification').forEach(n => n.remove());

            const notification = document.createElement("div");
            notification.className = "vote-notification";

            const actionText = {
                "Beaten": t("vote_action_beaten"),
                "TakeCards": t("vote_action_take")
                // "Pass" silindi
            }[data.action] || data.action;

            notification.innerHTML = `
        <div style="margin-bottom: 5px;">${data.playerName}</div>
        <div style="font-size: 1.2em;">${actionText} (${data.votes}/${data.required})</div>
    `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);

            console.log(`üó≥Ô∏è Vote: ${data.playerName} - ${data.action} (${data.votes}/${data.required})`);
        }

        function showRematchUI(entryFee) {
            const existingUI = document.getElementById("rematchUI");
            if (existingUI) existingUI.remove();

            const rematchDiv = document.createElement("div");
            rematchDiv.id = "rematchUI";
            rematchDiv.style.cssText = `
                    position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
                    background: rgba(0,0,0,0.95); padding: 30px; border-radius: 20px;
                    text-align: center; z-index: 2000; border: 3px solid #fbbf24;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.5);
                `;

            rematchDiv.innerHTML = `
                    <h2 style="margin-bottom: 20px; color: #fbbf24;">${t("rematch_title")}</h2>
                    ${entryFee > 0 ? `<p style="margin-bottom: 20px; font-size: 1.2em;">${t("rematch_fee", { fee: entryFee })}</p>` : ''}
                    <button class="btn btn-success" onclick="voteRematch()" style="width: 200px; margin: 0 auto;">
                        ${t("agree")}
                    </button>
                `;

            document.body.appendChild(rematchDiv);
        }

        function hideRematchUI() {
            const rematchUI = document.getElementById("rematchUI");
            if (rematchUI) rematchUI.remove();
        }

        async function voteRematch() {
            try {
                await connection.invoke("VoteRematch");
                showMessage(t("vote_recorded"), "success");
            } catch (err) {
                showMessage(t("error_prefix", { err: err.toString() }), "error");
            }
        }

        // Player Selection
        async function selectPlayerCount(count) {
            selectedPlayerCount = count;
            document.getElementById("roomOptionsPanel").style.display = "block";
            document.getElementById("roomsSection").style.display = "none";
            // reset temporary selections
            selectedDeckSize = 36;
            selectedBet = 0;
            selectedModes = { col1: 'atilan', col2: 'qonsular' };
            // update UI classes (simple)
            document.querySelectorAll('.deck-pill').forEach(p => p.classList.toggle('selected', parseInt(p.dataset.size) === selectedDeckSize));
            document.querySelectorAll('.bet-btn').forEach(b => b.classList.remove('active'));
            // update mode cards
            document.querySelectorAll('.mode-card').forEach(m => {
                const col = m.dataset.col;
                const val = m.dataset.value;
                if (col == '1') m.classList.toggle('selected', selectedModes.col1 === val);
                if (col == '2') m.classList.toggle('selected', selectedModes.col2 === val);
            });
            // mark selected player-option visually (persist selection)
            document.querySelectorAll('.player-option').forEach(opt => {
                const c = parseInt(opt.dataset.count, 10);
                opt.classList.toggle('selected', c === selectedPlayerCount);
            });
        }

        function goBackToPlayerSelect() {
            document.getElementById("roomsSection").style.display = "none";
            document.getElementById("roomOptionsPanel").style.display = "none";
            // keep the player-select visible and highlight the chosen count
            document.querySelectorAll('.player-option').forEach(opt => {
                const c = parseInt(opt.dataset.count, 10);
                opt.classList.toggle('selected', c === selectedPlayerCount);
            });
        }

        async function loadQuickRooms(playerCount) {
            try {
                const quickRooms = await connection.invoke("GetQuickRooms");
                const filtered = quickRooms.filter(r => r.maxPlayers === playerCount);
                const container = document.getElementById("quickRoomsList");

                if (filtered.length === 0) {
                    container.innerHTML = `<div class="empty-hand">${t("rooms_none")}</div>`;
                    return;
                }

                container.innerHTML = filtered.map(room => {
                    // ‚úÖ YENƒ∞ - Deck size v…ô transfer info (…ôg…ôr backend g√∂nd…ôrirs…ô)
                    const deckInfo = room.deckSize ? `<span class="deck-badge">${t("deck_size_cards", { count: room.deckSize })}</span>` : '';
                    const transferInfo = room.transferEnabled !== undefined
                        ? `<span class="transfer-badge ${room.transferEnabled ? '' : 'disabled'}">${room.transferEnabled ? t("transfer_on") : t("transfer_off")}</span>`
                        : '';

                    return `
                            <div class="room-card" onclick="joinRoom('${room.roomId}')">
                                <h3>${t("quick_room_title", { room: room.roomName })}</h3>
                                <div>${deckInfo} ${transferInfo}</div>
                                <div class="room-info">
                                    <span>üë• ${room.playerCount}/${room.maxPlayers}</span>
                                    ${room.entryFee > 0 ? `<span>üí∞ ${room.entryFee} AZN</span>` : ''}
                                </div>
                                ${room.totalPrize > 0 ? `<p style="color: #fbbf24; font-weight: 600;">${t("prize_display", { amount: room.totalPrize })}</p>` : ''}
                                <span class="room-status waiting">${t("room_waiting")}</span>
                            </div>
                        `;
                }).join('');
            } catch (err) {
                console.error(err);
                container.innerHTML = `<div class="empty-hand">${t("loading_error")}</div>`;
            }
        }

        // ===== Room options helpers =====
        function toggleDeckSize(size) {
            selectedDeckSize = size;
            document.querySelectorAll('.deck-pill').forEach(p => p.classList.toggle('selected', parseInt(p.dataset.size) === size));
        }

        function selectBet(amount) {
            selectedBet = amount;
            document.querySelectorAll('.bet-btn').forEach(b => {
                const v = parseFloat(b.textContent.trim());
                b.classList.toggle('active', v === amount);
            });
        }

        function selectMode(col, value) {
            if (col === 1) {
                selectedModes.col1 = value;
            } else if (col === 2) {
                selectedModes.col2 = value;
            }
            document.querySelectorAll('.mode-card').forEach(m => {
                const c = parseInt(m.dataset.col, 10);
                const val = m.dataset.value;
                if (c === 1) m.classList.toggle('selected', selectedModes.col1 === val);
                if (c === 2) m.classList.toggle('selected', selectedModes.col2 === val);
            });
        }

        async function startMatch() {
            // ensure SignalR connection is active to avoid invocation errors
            try {
                if (connection && typeof signalR !== 'undefined' && connection.state !== signalR.HubConnectionState.Connected) {
                    await connection.start();
                }
            } catch (connErr) {
                console.error('Connection start failed before startMatch:', connErr);
                showMessage(t('server_connect_fail_retry'), 'error');
                return;
            }
            if (!selectedPlayerCount) {
                showMessage(t('select_player_count'), 'warning');
                return;
            }

            showMessage(t('room_searching'), 'info');
            try {
                // Try to find an existing quick room that matches criteria
                const quickRooms = await connection.invoke('GetQuickRooms');
                const match = quickRooms.find(r => r.maxPlayers === selectedPlayerCount && (r.entryFee || 0) === (selectedBet || 0) && (!r.deckSize || r.deckSize === selectedDeckSize));
                if (match) {
                    joinRoom(match.roomId);
                    return;
                }

                // If not found, attempt to create a room (try common method names)
                const createPayload = { maxPlayers: selectedPlayerCount, entryFee: selectedBet || 0, deckSize: selectedDeckSize, modes: [selectedModes.col1, selectedModes.col2] };
                try {
                    await connection.invoke('CreateRoom', createPayload);
                    showMessage(t('room_create_success'), 'success');
                } catch (cErr) {
                    try {
                        await connection.invoke('CreateQuickRoom', createPayload);
                        showMessage(t('room_create_success'), 'success');
                    } catch (cErr2) {
                        showMessage(t('room_create_unsupported'), 'error');
                        console.error('Create room errors:', cErr, cErr2);
                    }
                }
            } catch (err) {
                console.error('Start match error:', err);
                showMessage(t('room_search_error'), 'error');
            }
        }

        async function joinRoom(roomId) {
            try {
                await connection.invoke("JoinRoom", roomId);
            } catch (err) {
                showMessage(t("join_room_failed"), "error");
            }
        }

        async function sendQuickMsg(emoji, message) {
            try {
                await connection.invoke("SendQuickMessage", emoji, message);
            } catch (err) {
                console.error("Quick message error:", err);
            }
        }

        // ============ Rendering Functions ============

        function renderTrumpCard(card) {
            if (!card) return;
            const container = document.getElementById("trumpCardContainer");
            const cardDiv = createCardElement(card, false, false);
            container.innerHTML = '';
            container.appendChild(cardDiv);
        }

        function renderPlayers(players) {
            const container = document.getElementById("playersSection");
            container.innerHTML = players.map(player => {
                let roleClass = '';
                let roleText = '';

                if (player.isAttacker) {
                    roleClass = 'attacker';
                    roleText = `<span class="player-role attacker">${t("role_attacker")}</span>`;
                } else if (player.isDefender) {
                    roleClass = 'defender';
                    roleText = `<span class="player-role defender">${t("role_defender")}</span>`;
                }

                return `
                        <div class="player-card ${roleClass}">
                            <div class="player-name">${player.name}</div>
                            <div class="player-cards-count">${t("card_count", { count: player.cardCount })}</div>
                            ${roleText}
                        </div>
                    `;
            }).join('');
        }

        function renderTableCards(state) {
            const container = document.getElementById("tableCards");

            const hasDefended = state.defendedCards && state.defendedCards.length > 0;
            const hasUndefended = state.tableCards && state.tableCards.length > 0;

            if (!hasDefended && !hasUndefended) {
                container.innerHTML = `<div class="empty-hand">${t("table_empty")}</div>`;
                return;
            }

            container.innerHTML = '';

            let isDefender = false;
            if (currentUser && state.players) {
                const myUserId = parseInt(currentUser.userId);
                const myPlayer = state.players.find(p => p.userId === myUserId);
                if (myPlayer) {
                    isDefender = myPlayer.isDefender;
                }
            }

            // 1. Defended pairs
            if (hasDefended) {
                state.defendedCards.forEach(pair => {
                    const pairDiv = document.createElement('div');
                    pairDiv.className = 'card-pair';
                    pairDiv.style.border = '2px solid rgba(16, 185, 129, 0.5)';
                    pairDiv.style.background = 'rgba(16, 185, 129, 0.1)';
                    pairDiv.style.padding = '10px';
                    pairDiv.style.borderRadius = '10px';

                    const attackCardEl = createCardElement(pair.attackCard, false, false);
                    const defendCardEl = createCardElement(pair.defendCard, false, false);

                    pairDiv.appendChild(attackCardEl);
                    pairDiv.appendChild(defendCardEl);
                    container.appendChild(pairDiv);
                });
            }

            // 2. Undefended cards
            if (hasUndefended) {
                state.tableCards.forEach(card => {
                    const cardWrapper = document.createElement('div');
                    const cardEl = createCardElement(card, false, false);

                    if (isDefender) {
                        cardWrapper.className = 'card-pair card-drop-zone';
                        cardWrapper.style.border = '3px dashed rgba(59, 130, 246, 0.8)';
                        cardWrapper.style.padding = '20px';
                        cardWrapper.style.borderRadius = '15px';
                        cardWrapper.style.minHeight = '170px';
                        cardWrapper.style.minWidth = '130px';
                        cardWrapper.style.display = 'flex';
                        cardWrapper.style.alignItems = 'center';
                        cardWrapper.style.justifyContent = 'center';
                        cardWrapper.style.background = 'rgba(59, 130, 246, 0.1)';

                        cardWrapper.setAttribute('data-attack-rank', card.rank);
                        cardWrapper.setAttribute('data-attack-suit', card.suit);

                        cardWrapper.ondragover = function (e) {
                            e.preventDefault();
                            e.stopPropagation();
                            this.style.background = 'rgba(16, 185, 129, 0.3)';
                            this.style.borderColor = '#10b981';
                            return false;
                        };

                        cardWrapper.ondragleave = function (e) {
                            e.preventDefault();
                            this.style.background = 'rgba(59, 130, 246, 0.1)';
                            this.style.borderColor = 'rgba(59, 130, 246, 0.8)';
                        };

                        cardWrapper.ondrop = function (e) {
                            e.preventDefault();
                            e.stopPropagation();
                            this.style.background = 'rgba(59, 130, 246, 0.1)';
                            this.style.borderColor = 'rgba(59, 130, 246, 0.8)';
                            handleDropOnZone(this);
                            return false;
                        };
                    } else {
                        cardWrapper.className = 'card-pair';
                        cardWrapper.style.border = '2px solid rgba(239, 68, 68, 0.3)';
                        cardWrapper.style.padding = '10px';
                        cardWrapper.style.borderRadius = '10px';
                    }

                    cardWrapper.appendChild(cardEl);
                    container.appendChild(cardWrapper);
                });
            }
        }

        function renderPlayerCards() {
            const container = document.getElementById("playerCards");

            if (myCards.length === 0) {
                container.innerHTML = `<div class="empty-hand">${t("cards_none")}</div>`;
                return;
            }

            container.innerHTML = '';

            let canAttack = false;
            let isDefender = false;
            let canTransfer = false;

            if (gameState && gameState.isGameActive && currentUser) {
                const myPlayer = gameState.players.find(p => p.userId === currentUser.userId);

                if (myPlayer) {
                    isDefender = myPlayer.isDefender;
                    const isMainAttacker = myPlayer.isAttacker;
                    const hasCardsOnTable = (gameState.tableCards && gameState.tableCards.length > 0) ||
                        (gameState.defendedCards && gameState.defendedCards.length > 0);

                    if (!isDefender) {
                        if (isMainAttacker || hasCardsOnTable) {
                            canAttack = true;
                        }
                    }

                    // ‚úÖ YENƒ∞ - Transfer yoxlamasƒ±
                    if (isDefender && gameState.transferEnabled && gameState.tableCards && gameState.tableCards.length === 1) {
                        canTransfer = true;
                    }
                }
            }

            myCards.forEach(card => {
                const cardElement = createCardElement(card, false, true);

                cardElement.draggable = true;
                cardElement.classList.add('draggable');
                cardElement.addEventListener('dragstart', (e) => handleDragStart(e, card));
                cardElement.addEventListener('dragend', handleDragEnd);

                // ‚úÖ YENƒ∞ - Transfer highlight
                if (canTransfer && gameState.tableCards) {
                    const firstTableCard = gameState.tableCards[0];
                    if (card.rank === firstTableCard.rank) {
                        cardElement.classList.add('transfer-highlight');
                        cardElement.onclick = function () {
                            transferAttack(card);
                        };
                    }
                }

                if (canAttack) {
                    const tableRanks = new Set();

                    if (gameState.tableCards) {
                        gameState.tableCards.forEach(c => tableRanks.add(c.rank));
                    }

                    if (gameState.defendedCards) {
                        gameState.defendedCards.forEach(pair => {
                            tableRanks.add(pair.attackCard.rank);
                            tableRanks.add(pair.defendCard.rank);
                        });
                    }

                    const canPlayThisCard = tableRanks.size === 0 || tableRanks.has(card.rank);

                    if (canPlayThisCard) {
                        cardElement.style.cursor = 'pointer';
                        cardElement.style.border = '3px solid rgba(239, 68, 68, 0.8)';
                        cardElement.style.boxShadow = '0 0 15px rgba(239, 68, 68, 0.5)';

                        cardElement.onclick = function () {
                            attackWithCard(card);
                        };
                    } else {
                        cardElement.style.opacity = '0.5';
                        cardElement.style.cursor = 'not-allowed';
                    }
                }

                container.appendChild(cardElement);
            });
        }

        function createCardElement(card, isSelected = false, isClickable = false) {
            const suit = card.suit.toLowerCase();
            const rank = rankNames[card.rank] || card.rank;
            const suitIcon = suitIcons[card.suit];

            const cardDiv = document.createElement('div');
            cardDiv.className = `card ${suit} ${isSelected ? 'selected' : ''}`;
            cardDiv.innerHTML = `
                    <div class="card-rank">${rank}</div>
                    <div class="card-suit">${suitIcon}</div>
                    <div class="card-rank">${rank}</div>
                `;

            return cardDiv;
        }

        // ============ Drag & Drop ============

        function handleDragStart(e, card) {
            const isMyCard = myCards.some(c => c.rank === card.rank && c.suit === card.suit);

            if (!isMyCard) {
                e.preventDefault();
                return;
            }

            draggedCard = card;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', JSON.stringify(card));
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            document.querySelectorAll('.card-drop-zone').forEach(zone => {
                zone.classList.remove('drag-over');
            });
        }

        async function handleDropOnZone(dropZone) {
            if (!draggedCard) return;

            const attackRank = dropZone.getAttribute('data-attack-rank');
            const attackSuit = dropZone.getAttribute('data-attack-suit');

            if (!attackRank || !attackSuit) {
                showMessage(t("defend_missing_attack"), "error");
                return;
            }

            try {
                await connection.invoke("Defend", [{
                    AttackCard: { rank: attackRank, suit: attackSuit },
                    DefendCard: draggedCard
                }]);
                showMessage(t("defense_sent"), "success");
            } catch (err) {
                showMessage(t("defense_failed"), "error");
            }

            draggedCard = null;
        }

        // ============ Game Actions ============

        async function attackWithCard(card) {
            if (!gameState || !currentUser) return;

            const myPlayer = gameState.players.find(p => p.userId === currentUser.userId);
            if (!myPlayer) return;

            if (myPlayer.isDefender) {
                showMessage(t("defender_cant_attack"), "warning");
                return;
            }

            const hasCardsOnTable = (gameState.tableCards && gameState.tableCards.length > 0) ||
                (gameState.defendedCards && gameState.defendedCards.length > 0);

            if (!hasCardsOnTable && !myPlayer.isAttacker) {
                showMessage(t("only_attacker_first"), "warning");
                return;
            }

            try {
                await connection.invoke("Attack", [card]);
                showMessage(myPlayer.isAttacker ? t("attack_sent") : t("attack_added"), "success");
            } catch (err) {
                showMessage(t("attack_failed", { err: err.toString() }), "error");
            }
        }

        // ‚úÖ YENƒ∞ - Transfer Function
        async function transferAttack(card) {
            if (!gameState || !gameState.transferEnabled) {
                showMessage(t("transfer_not_possible"), "error");
                return;
            }

            try {
                await connection.invoke("TransferAttack", card);
                showMessage(t("transfer_sent"), "success");
            } catch (err) {
                showMessage(t("transfer_failed", { err: err.toString() }), "error");
            }
        }
        // ‚úÖ YENƒ∞ - Update Action Buttons (Beaten + TakeCards + Pass)
        function updateActionButtons(state) {
            const beatenBtn = document.getElementById("beatenBtn");
            const takeBtn = document.getElementById("takeCardsBtn");

            if (!state.isGameActive || !currentUser) {
                beatenBtn.classList.add("hidden");
                takeBtn.classList.add("hidden");
                return;
            }

            const hasUndefendedCards = state.tableCards && state.tableCards.length > 0;
            const hasDefendedCards = state.defendedCards && state.defendedCards.length > 0;
            const hasAnyCards = hasUndefendedCards || hasDefendedCards;

            const myPlayer = state.players.find(p => p.userId === currentUser.userId);
            if (!myPlayer) {
                beatenBtn.classList.add("hidden");
                takeBtn.classList.add("hidden");
                return;
            }

            const isAttacker = myPlayer.isAttacker;
            const isDefender = myPlayer.isDefender;

            // ‚úÖ BEATEN - Yalnƒ±z Attacker + B√ºt√ºn kartlar m√ºdafi…ô olunubsa
            if (isAttacker && !hasUndefendedCards && hasDefendedCards) {
                beatenBtn.classList.remove("hidden");
                beatenBtn.textContent = t("beaten_btn");
            } else {
                beatenBtn.classList.add("hidden");
            }

            // ‚úÖ TAKECARDS - Defender v…ô Attacker + Masada kart varsa
            if ((isDefender || isAttacker) && hasAnyCards) {
                takeBtn.classList.remove("hidden");

                if (isDefender) {
                    takeBtn.textContent = t("take_cards_defender_btn");
                } else if (isAttacker) {
                    takeBtn.textContent = t("take_cards_attacker_btn");
                }
            } else {
                takeBtn.classList.add("hidden");
            }

            console.log('üéõÔ∏è Buttons updated:', {
                isAttacker,
                isDefender,
                beaten: !beatenBtn.classList.contains('hidden'),
                takeCards: !takeBtn.classList.contains('hidden')
            });
        }
        // ============ Button Event Listeners ============

        document.getElementById("beatenBtn").addEventListener("click", async () => {
            try {
                await connection.invoke("Beaten");
                console.log('‚úÖ Beaten sent');
            } catch (err) {
                showMessage(t("beaten_failed"), "error");
                console.error(err);
            }
        });

        document.getElementById("takeCardsBtn").addEventListener("click", async () => {
            try {
                await connection.invoke("TakeCards");
                console.log('‚úÖ TakeCards vote sent');
            } catch (err) {
                showMessage(t("take_cards_vote_failed"), "error");
                console.error(err);
            }
        });
        document.getElementById("leaveRoomBtn").addEventListener("click", async () => {
            if (!confirm(t("leave_room_confirm"))) return;
            try {
                await connection.invoke("LeaveRoom");
            } catch (err) {
                showMessage(t("leave_room_failed"), "error");
            }
        });

        function showMessage(text, type = "info") {
            const container = document.getElementById("messages");
            const msg = document.createElement("div");
            msg.className = `message ${type}`;
            msg.textContent = text;
            container.appendChild(msg);

            setTimeout(() => {
                msg.style.animation = "slideIn 0.3s ease-out reverse";
                setTimeout(() => msg.remove(), 300);
            }, 4000);
        }
        function backToGames() {
            window.parent.postMessage({ type: 'BACK_TO_GAMES', payload: {} }, '*');
        }
        // Remove the casino loader once SignalR is ready
        function hideLoader() {
            const loader = document.getElementById('durakLoader');
            if (!loader) return;
            loader.classList.add('fade-out');
            setTimeout(() => loader.remove(), 700);
        }
        // init();
        setLanguage('en');
        console.log('‚úÖ Durak Game Ready! Drag & Drop + Beaten Active.');
    </script>
</body>

</html>
